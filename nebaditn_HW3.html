<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>nebaditn_HW3 - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableNotebookNotifications":true,"enableSshKeyUI":true,"defaultInteractivePricePerDBU":0.4,"enableClusterMetricsUI":true,"useReactTableCreateView":true,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableReservoirTableUI":false,"enableClearStateFeature":true,"enableJobsAclsV2InUI":true,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"enableAttachExistingCluster":true,"resetJobListOnConnect":true,"serverlessDefaultSparkVersion":"latest-stable-scala2.11","maxCustomTags":45,"serverlessDefaultMaxWorkers":20,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":20396,"instance_type_id":"r3.xlarge","node_type_id":"r3.xlarge","description":"r3.xlarge","support_cluster_tags":true,"container_memory_mb":25495,"node_instance_type":{"instance_type_id":"r3.xlarge","provider":"AWS","local_disk_size_gb":80,"compute_units":13.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":31232,"num_cores":4,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":31232,"is_hidden":false,"category":"Memory Optimized","num_cores":4.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":44632,"instance_type_id":"r3.2xlarge","node_type_id":"r3.2xlarge","description":"r3.2xlarge","support_cluster_tags":true,"container_memory_mb":55790,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":62464,"is_hidden":false,"category":"Memory Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":93104,"instance_type_id":"r3.4xlarge","node_type_id":"r3.4xlarge","description":"r3.4xlarge","support_cluster_tags":true,"container_memory_mb":116380,"node_instance_type":{"instance_type_id":"r3.4xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":52.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":124928,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":124928,"is_hidden":false,"category":"Memory Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":190048,"instance_type_id":"r3.8xlarge","node_type_id":"r3.8xlarge","description":"r3.8xlarge","support_cluster_tags":true,"container_memory_mb":237560,"node_instance_type":{"instance_type_id":"r3.8xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":104.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":249856,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":249856,"is_hidden":false,"category":"Memory Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":0,"spark_heap_memory":20396,"instance_type_id":"r4.xlarge","node_type_id":"r4.xlarge","description":"r4.xlarge","support_cluster_tags":true,"container_memory_mb":25495,"node_instance_type":{"instance_type_id":"r4.xlarge","provider":"AWS","local_disk_size_gb":0,"compute_units":13.5,"number_of_ips":4,"local_disks":0,"reserved_compute_units":3.64,"gpus":0,"memory_mb":31232,"num_cores":4,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":31232,"is_hidden":false,"category":"Memory Optimized","num_cores":4.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":0,"spark_heap_memory":44632,"instance_type_id":"r4.2xlarge","node_type_id":"r4.2xlarge","description":"r4.2xlarge","support_cluster_tags":true,"container_memory_mb":55790,"node_instance_type":{"instance_type_id":"r4.2xlarge","provider":"AWS","local_disk_size_gb":0,"compute_units":27.0,"number_of_ips":4,"local_disks":0,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":62464,"is_hidden":false,"category":"Memory Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":0,"spark_heap_memory":93104,"instance_type_id":"r4.4xlarge","node_type_id":"r4.4xlarge","description":"r4.4xlarge","support_cluster_tags":true,"container_memory_mb":116380,"node_instance_type":{"instance_type_id":"r4.4xlarge","provider":"AWS","local_disk_size_gb":0,"compute_units":53.0,"number_of_ips":4,"local_disks":0,"reserved_compute_units":3.64,"gpus":0,"memory_mb":124928,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":124928,"is_hidden":false,"category":"Memory Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":0,"spark_heap_memory":190048,"instance_type_id":"r4.8xlarge","node_type_id":"r4.8xlarge","description":"r4.8xlarge","support_cluster_tags":true,"container_memory_mb":237560,"node_instance_type":{"instance_type_id":"r4.8xlarge","provider":"AWS","local_disk_size_gb":0,"compute_units":99.0,"number_of_ips":4,"local_disks":0,"reserved_compute_units":3.64,"gpus":0,"memory_mb":249856,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":249856,"is_hidden":false,"category":"Memory Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":8079,"instance_type_id":"c3.2xlarge","node_type_id":"c3.2xlarge","description":"c3.2xlarge","support_cluster_tags":true,"container_memory_mb":10099,"node_instance_type":{"instance_type_id":"c3.2xlarge","provider":"AWS","local_disk_size_gb":80,"compute_units":28.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":15360,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":15360,"is_hidden":false,"category":"Compute Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":19998,"instance_type_id":"c3.4xlarge","node_type_id":"c3.4xlarge","description":"c3.4xlarge","support_cluster_tags":true,"container_memory_mb":24998,"node_instance_type":{"instance_type_id":"c3.4xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":55.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":30720,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":30720,"is_hidden":false,"category":"Compute Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":43837,"instance_type_id":"c3.8xlarge","node_type_id":"c3.8xlarge","description":"c3.8xlarge","support_cluster_tags":true,"container_memory_mb":54796,"node_instance_type":{"instance_type_id":"c3.8xlarge","provider":"AWS","local_disk_size_gb":320,"compute_units":108.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":61440,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":61440,"is_hidden":false,"category":"Compute Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":0,"spark_heap_memory":8079,"instance_type_id":"c4.2xlarge","node_type_id":"c4.2xlarge","description":"c4.2xlarge","support_cluster_tags":true,"container_memory_mb":10099,"node_instance_type":{"instance_type_id":"c4.2xlarge","provider":"AWS","local_disk_size_gb":0,"compute_units":31.0,"number_of_ips":4,"local_disks":0,"reserved_compute_units":3.64,"gpus":0,"memory_mb":15360,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":15360,"is_hidden":false,"category":"Compute Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":0,"spark_heap_memory":19998,"instance_type_id":"c4.4xlarge","node_type_id":"c4.4xlarge","description":"c4.4xlarge","support_cluster_tags":true,"container_memory_mb":24998,"node_instance_type":{"instance_type_id":"c4.4xlarge","provider":"AWS","local_disk_size_gb":0,"compute_units":62.0,"number_of_ips":4,"local_disks":0,"reserved_compute_units":3.64,"gpus":0,"memory_mb":30720,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":30720,"is_hidden":false,"category":"Compute Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":0,"spark_heap_memory":43837,"instance_type_id":"c4.8xlarge","node_type_id":"c4.8xlarge","description":"c4.8xlarge","support_cluster_tags":true,"container_memory_mb":54796,"node_instance_type":{"instance_type_id":"c4.8xlarge","provider":"AWS","local_disk_size_gb":0,"compute_units":132.0,"number_of_ips":4,"local_disks":0,"reserved_compute_units":3.64,"gpus":0,"memory_mb":61440,"num_cores":36,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":61440,"is_hidden":false,"category":"Compute Optimized","num_cores":36.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":20396,"instance_type_id":"i2.xlarge","node_type_id":"i2.xlarge","description":"i2.xlarge","support_cluster_tags":true,"container_memory_mb":25495,"node_instance_type":{"instance_type_id":"i2.xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":14.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":31232,"num_cores":4,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":31232,"is_hidden":false,"category":"Storage Optimized","num_cores":4.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":44632,"instance_type_id":"i2.2xlarge","node_type_id":"i2.2xlarge","description":"i2.2xlarge","support_cluster_tags":true,"container_memory_mb":55790,"node_instance_type":{"instance_type_id":"i2.2xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":27.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":62464,"is_hidden":false,"category":"Storage Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":93104,"instance_type_id":"i2.4xlarge","node_type_id":"i2.4xlarge","description":"i2.4xlarge","support_cluster_tags":true,"container_memory_mb":116380,"node_instance_type":{"instance_type_id":"i2.4xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":53.0,"number_of_ips":4,"local_disks":4,"reserved_compute_units":3.64,"gpus":0,"memory_mb":124928,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":124928,"is_hidden":false,"category":"Storage Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":1,"support_ssh":true,"num_gpus":0,"spark_heap_memory":190048,"instance_type_id":"i2.8xlarge","node_type_id":"i2.8xlarge","description":"i2.8xlarge","support_cluster_tags":true,"container_memory_mb":237560,"node_instance_type":{"instance_type_id":"i2.8xlarge","provider":"AWS","local_disk_size_gb":800,"compute_units":104.0,"number_of_ips":4,"local_disks":8,"reserved_compute_units":3.64,"gpus":0,"memory_mb":249856,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":249856,"is_hidden":false,"category":"Storage Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":0,"spark_heap_memory":20396,"instance_type_id":"i3.xlarge","node_type_id":"i3.xlarge","description":"i3.xlarge","support_cluster_tags":true,"container_memory_mb":25495,"node_instance_type":{"instance_type_id":"i3.xlarge","provider":"AWS","local_disk_size_gb":950,"compute_units":13.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":31232,"num_cores":4,"local_disk_type":"NVME","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":31232,"is_hidden":false,"category":"Storage Optimized","num_cores":4.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":0,"spark_heap_memory":44632,"instance_type_id":"i3.2xlarge","node_type_id":"i3.2xlarge","description":"i3.2xlarge","support_cluster_tags":true,"container_memory_mb":55790,"node_instance_type":{"instance_type_id":"i3.2xlarge","provider":"AWS","local_disk_size_gb":1900,"compute_units":27.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"NVME","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":62464,"is_hidden":false,"category":"Storage Optimized","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":0,"spark_heap_memory":93104,"instance_type_id":"i3.4xlarge","node_type_id":"i3.4xlarge","description":"i3.4xlarge","support_cluster_tags":true,"container_memory_mb":116380,"node_instance_type":{"instance_type_id":"i3.4xlarge","provider":"AWS","local_disk_size_gb":1900,"compute_units":53.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":124928,"num_cores":16,"local_disk_type":"NVME","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":124928,"is_hidden":false,"category":"Storage Optimized","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":0,"spark_heap_memory":190048,"instance_type_id":"i3.8xlarge","node_type_id":"i3.8xlarge","description":"i3.8xlarge","support_cluster_tags":true,"container_memory_mb":237560,"node_instance_type":{"instance_type_id":"i3.8xlarge","provider":"AWS","local_disk_size_gb":1900,"compute_units":99.0,"number_of_ips":4,"local_disks":4,"reserved_compute_units":3.64,"gpus":0,"memory_mb":249856,"num_cores":32,"local_disk_type":"NVME","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":249856,"is_hidden":false,"category":"Storage Optimized","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":1,"spark_heap_memory":44632,"instance_type_id":"p2.xlarge","node_type_id":"p2.xlarge","description":"p2.xlarge (beta)","support_cluster_tags":true,"container_memory_mb":55790,"node_instance_type":{"instance_type_id":"p2.xlarge","provider":"AWS","local_disk_size_gb":0,"compute_units":12.0,"number_of_ips":4,"local_disks":0,"reserved_compute_units":3.64,"gpus":1,"memory_mb":62464,"num_cores":4,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":62464,"is_hidden":false,"category":"GPU Accelerated","num_cores":4.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":8,"spark_heap_memory":383936,"instance_type_id":"p2.8xlarge","node_type_id":"p2.8xlarge","description":"p2.8xlarge (beta)","support_cluster_tags":true,"container_memory_mb":479920,"node_instance_type":{"instance_type_id":"p2.8xlarge","provider":"AWS","local_disk_size_gb":0,"compute_units":94.0,"number_of_ips":4,"local_disks":0,"reserved_compute_units":3.64,"gpus":8,"memory_mb":499712,"num_cores":32,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":499712,"is_hidden":false,"category":"GPU Accelerated","num_cores":32.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":16,"spark_heap_memory":577824,"instance_type_id":"p2.16xlarge","node_type_id":"p2.16xlarge","description":"p2.16xlarge (beta)","support_cluster_tags":true,"container_memory_mb":722280,"node_instance_type":{"instance_type_id":"p2.16xlarge","provider":"AWS","local_disk_size_gb":0,"compute_units":188.0,"number_of_ips":4,"local_disks":0,"reserved_compute_units":3.64,"gpus":16,"memory_mb":749568,"num_cores":64,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":749568,"is_hidden":false,"category":"GPU Accelerated","num_cores":64.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":0,"spark_heap_memory":8873,"instance_type_id":"m4.xlarge","node_type_id":"m4.xlarge","description":"m4.xlarge","support_cluster_tags":true,"container_memory_mb":11092,"node_instance_type":{"instance_type_id":"m4.xlarge","provider":"AWS","local_disk_size_gb":0,"compute_units":13.0,"number_of_ips":4,"local_disks":0,"reserved_compute_units":3.64,"gpus":0,"memory_mb":16384,"num_cores":4,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":16384,"is_hidden":false,"category":"General Purpose","num_cores":4.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":0,"spark_heap_memory":21587,"instance_type_id":"m4.2xlarge","node_type_id":"m4.2xlarge","description":"m4.2xlarge","support_cluster_tags":true,"container_memory_mb":26984,"node_instance_type":{"instance_type_id":"m4.2xlarge","provider":"AWS","local_disk_size_gb":0,"compute_units":26.0,"number_of_ips":4,"local_disks":0,"reserved_compute_units":3.64,"gpus":0,"memory_mb":32768,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":32768,"is_hidden":false,"category":"General Purpose","num_cores":8.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":0,"spark_heap_memory":47015,"instance_type_id":"m4.4xlarge","node_type_id":"m4.4xlarge","description":"m4.4xlarge","support_cluster_tags":true,"container_memory_mb":58769,"node_instance_type":{"instance_type_id":"m4.4xlarge","provider":"AWS","local_disk_size_gb":0,"compute_units":53.5,"number_of_ips":4,"local_disks":0,"reserved_compute_units":3.64,"gpus":0,"memory_mb":65536,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":65536,"is_hidden":false,"category":"General Purpose","num_cores":16.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"display_order":0,"support_ssh":true,"num_gpus":0,"spark_heap_memory":123299,"instance_type_id":"m4.10xlarge","node_type_id":"m4.10xlarge","description":"m4.10xlarge","support_cluster_tags":true,"container_memory_mb":154124,"node_instance_type":{"instance_type_id":"m4.10xlarge","provider":"AWS","local_disk_size_gb":0,"compute_units":124.5,"number_of_ips":4,"local_disks":0,"reserved_compute_units":3.64,"gpus":0,"memory_mb":163840,"num_cores":40,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":163840,"is_hidden":false,"category":"General Purpose","num_cores":40.0,"support_port_forwarding":true,"support_ebs_volumes":true,"is_deprecated":false},{"support_ssh":false,"spark_heap_memory":23800,"instance_type_id":"r3.2xlarge","node_type_id":"memory-optimized","description":"Memory Optimized (legacy)","support_cluster_tags":false,"container_memory_mb":28000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":26.0,"number_of_ips":4,"local_disks":1,"reserved_compute_units":3.64,"gpus":0,"memory_mb":62464,"num_cores":8,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":30720,"is_hidden":true,"category":"Memory Optimized","num_cores":4.0,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":true},{"support_ssh":false,"spark_heap_memory":9702,"instance_type_id":"c3.4xlarge","node_type_id":"compute-optimized","description":"Compute Optimized (legacy)","support_cluster_tags":false,"container_memory_mb":12128,"node_instance_type":{"instance_type_id":"c3.4xlarge","provider":"AWS","local_disk_size_gb":160,"compute_units":55.0,"number_of_ips":4,"local_disks":2,"reserved_compute_units":3.64,"gpus":0,"memory_mb":30720,"num_cores":16,"local_disk_type":"AHCI","max_attachable_disks":10,"supported_disk_types":[{"ebs_volume_type":"GENERAL_PURPOSE_SSD"},{"ebs_volume_type":"THROUGHPUT_OPTIMIZED_HDD"}],"reserved_memory_mb":4800},"memory_mb":15360,"is_hidden":true,"category":"Compute Optimized","num_cores":8.0,"support_port_forwarding":false,"support_ebs_volumes":false,"is_deprecated":true}],"default_node_type_id":"i3.xlarge"},"sqlAclsDisabledMap":{"spark.databricks.acl.enabled":"false","spark.databricks.acl.sqlOnly":"false"},"enableDatabaseSupportClusterChoice":true,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":0,"serverlessClusterProductName":"Serverless Pool","showS3TableImportOption":true,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"timerUpdateQueueLength":100,"sqlAclsEnabledMap":{"spark.databricks.acl.enabled":"true","spark.databricks.acl.sqlOnly":"true"},"enableLargeResultDownload":true,"maxElasticDiskCapacityGB":5000,"serverlessDefaultMinWorkers":2,"zoneInfos":[{"id":"us-east-1e","isDefault":true},{"id":"us-east-1b","isDefault":false},{"id":"us-east-1d","isDefault":false},{"id":"us-east-1f","isDefault":false},{"id":"us-east-1c","isDefault":false},{"id":"us-east-1a","isDefault":false}],"enableCustomSpotPricingUIByTier":true,"serverlessClustersEnabled":true,"enableFindAndReplace":true,"disallowUrlImportExceptFromDocs":false,"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":false,"enableBitbucketCloud":true,"enableMaxConcurrentRuns":true,"createTableInNotebookS3Link":{"url":"https://docs.databricks.com/_static/notebooks/data-import/s3.html","displayName":"S3","workspaceFileName":"S3 Example"},"sanitizeHtmlResult":false,"enableJobAclsConfig":false,"enableFullTextSearch":true,"enableElasticSparkUI":true,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"useAutoscalingByDefault":true,"enableAzureToolbar":false,"fileStoreBase":"FileStore","enableEmailInAzure":false,"enableRLibraries":true,"enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":true,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"checkBeforeAddingAadUser":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"createTableInNotebookDBFSLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/dbfs.html","displayName":"DBFS","workspaceFileName":"DBFS Example"},"perClusterAutoterminationEnabled":true,"enableNotebookCommandNumbers":true,"allowStyleInSanitizedHtml":false,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"3.3.x-gpu-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, GPU, Scala 2.11)","packageLabel":"spark-image-280a8d41cd338f5b48d43eb87622c542c6e6584c430f6d3afe8f3401b9607cb9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.11","displayName":"Spark 2.1.1-db5 (Scala 2.11)","packageLabel":"spark-image-08d9fc1551087e0876236f19640c4a83116b1649f15137427d21c9056656e80e","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.10","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-dd410c68e21c3c563ad6128d35705b605d70530124d55aff1dd12d7e15adfa20","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1, deprecated)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.1-db6-scala2.10","displayName":"Spark 2.1.1-db6 (Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.x-gpu-scala2.11","displayName":"Spark 2.1 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-d613235f93e0f29838beb2079a958c02a192ed67a502192bc67a8a5f2fb37f35","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"latest-stable-gpu-scala2.11","displayName":"Latest stable (3.3, GPU, Scala 2.11)","packageLabel":"spark-image-280a8d41cd338f5b48d43eb87622c542c6e6584c430f6d3afe8f3401b9607cb9","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.11","displayName":"3.4 beta (Scala 2.11)","packageLabel":"spark-image-918aa133441c006a4ee3702819fabceada309cf3ec29d43e8a3cdb8029dd2231","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.2.x-scala2.10","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-557788bea0eea16bbf7a8ba13ace07e64dd7fc86270bd5cea086097fe886431f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"latest-experimental-scala2.10","displayName":"Latest experimental (3.4 snapshot, Scala 2.10)","packageLabel":"spark-image-a03f42d1c365945a4971bcc14bd8e5e8a35f2e63536ac976a1bbda5eff26cc0e","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.11","displayName":"Latest RC (3.4, Scala 2.11)","packageLabel":"spark-image-918aa133441c006a4ee3702819fabceada309cf3ec29d43e8a3cdb8029dd2231","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-stable-scala2.11","displayName":"Latest stable (3.3, Scala 2.11)","packageLabel":"spark-image-73a161da0570b3f51c8eb238602af2f5561789ea80b25c69a48691fc84e2d974","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-scala2.10","displayName":"Latest RC (3.4, Scala 2.10)","packageLabel":"spark-image-185b0343e18eb14c9927ef87453f5d64bca479c566dc0226ceb9adf847c950c3","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-stable-scala2.10","displayName":"Latest stable (3.3, Scala 2.10)","packageLabel":"spark-image-dd410c68e21c3c563ad6128d35705b605d70530124d55aff1dd12d7e15adfa20","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.1-db5-scala2.10","displayName":"Spark 2.1.1-db5 (Scala 2.10)","packageLabel":"spark-image-74133df2c13950431298d1cab3e865c191d83ac33648a8590495c52fc644c654","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.4.x-gpu-scala2.11","displayName":"3.4 beta (GPU, Scala 2.11)","packageLabel":"spark-image-4e470a51a5b71e69c437053c4d782e3ec08ad02f954dea61b2cf3493be70d076","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1, deprecated)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"latest-experimental-gpu-scala2.11","displayName":"Latest experimental (3.4 snapshot, GPU, Scala 2.11)","packageLabel":"spark-image-cf686fcc077800f7b56cb47aa5c0590e3dd7d06b34d3fa9c5c5db2a558ae49b0","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.2.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.0.x-scala2.11","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-67ab3a06d1e83d5b60df7063245eb419a2e9fe329aeeb7e7d9713332c669bb17","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-177f3f02a6a3432d30068332dc857b9161345bdd2ee8a2d2de05bb05cb4b0f4c","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.1.x-scala2.11","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-241fa8b78ee6343242b1756b18076270894385ff40a81172a6fb5eadf66155d3","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.1.x-scala2.10","displayName":"3.1 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-7efac6b9a8f2da59cb4f6d0caac46cfcb3f1ebf64c8073498c42d0360f846714","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.3.x-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-73a161da0570b3f51c8eb238602af2f5561789ea80b25c69a48691fc84e2d974","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1, deprecated)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.1.1-db6-scala2.11","displayName":"Spark 2.1.1-db6 (Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"latest-experimental-scala2.11","displayName":"Latest experimental (3.4 snapshot, Scala 2.11)","packageLabel":"spark-image-3d803db21db15e7fc8a5b7016b9a5d9fcbe7575646470943e2d7312f98ea705a","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"3.2.x-scala2.11","displayName":"3.2 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-5537926238bc55cb6cd76ee0f0789511349abead3781c4780721a845f34b5d4e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-fdad9ef557700d7a8b6bde86feccbcc3c71d1acdc838b0fd299bd19956b1076e","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"3.0.x-scala2.10","displayName":"3.0 (includes Apache Spark 2.2.0, Scala 2.10)","packageLabel":"spark-image-d549f2d4a523994ecdf37e531b51d5ec7d8be51534bb0ca5322eaad28ba8f557","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false,"capabilities":[]},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]},{"key":"latest-rc-gpu-scala2.11","displayName":"Latest RC (3.4 GPU, Scala 2.11)","packageLabel":"spark-image-4e470a51a5b71e69c437053c4d782e3ec08ad02f954dea61b2cf3493be70d076","upgradable":true,"deprecated":false,"customerVisible":false,"capabilities":[]},{"key":"3.4.x-scala2.10","displayName":"3.4 beta (Scala 2.10)","packageLabel":"spark-image-185b0343e18eb14c9927ef87453f5d64bca479c566dc0226ceb9adf847c950c3","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":["SUPPORTS_END_TO_END_ENCRYPTION"]}],"enablePresentationMode":false,"enableClearStateAndRunAll":true,"enableRestrictedClusterCreation":false,"enableFeedback":true,"enableClusterAutoScaling":true,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":8,"serverContinuationTimeoutMillis":10000,"jobsUnreachableThresholdMillis":60000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":true,"createTableInNotebookImportedFileLink":{"url":"https://docs.databricks.com/_static/notebooks/data-import/imported-file.html","displayName":"Imported File","workspaceFileName":"Imported File Example"},"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","showDbuPricing":true,"databricksDocsBaseHostname":"docs.databricks.com","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"i3.4xlarge":4,"class-node":1,"m4.2xlarge":1.5,"r4.xlarge":1,"m4.4xlarge":3,"r4.16xlarge":16,"Standard_DS11":0.5,"p2.8xlarge":16,"m4.10xlarge":8,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"Standard_DS15_v2":8,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"m4.xlarge":0.75,"r4.8xlarge":8,"Standard_DS14_v2":4,"r4.large":0.5,"Standard_DS12":1,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"i3.large":0.75,"memory-optimized":1,"m4.large":0.375,"p2.16xlarge":24,"i3.8xlarge":8,"i3.16xlarge":16,"Standard_DS12_v2":1,"Standard_DS13":2,"Standard_DS11_v2":0.5,"Standard_DS13_v2":2,"c3.2xlarge":1,"Standard_L4s":1.5,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"i3.2xlarge":2,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":12,"c4.8xlarge":4,"i3.xlarge":1,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"tableFilesBaseFolder":"/tables","enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":true,"homePageWelcomeMessage":"Welcome to ","metastoreServiceRowLimit":1000000,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":true,"enableNotebookHistoryDiffing":true,"branch":"2.57.766","accountsLimit":-1,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"useAADLogin":false,"enableStructuredStreamingNbOptimizations":true,"enableNotebookGitBranching":true,"local":false,"enableNotebookLazyRenderWrapper":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"showReleaseNote":true,"displayDefaultContainerMemoryGB":30,"enableNotebookCommandMode":true,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"removePasswordInAccountSettings":false,"preferStartTerminatedCluster":false,"enableUserInviteWorkflow":true,"createTableConnectorOptionLinks":[{"url":"https://docs.databricks.com/_static/notebooks/redshift.html","displayName":"Amazon Redshift","workspaceFileName":"Amazon Redshift Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-kinesis.html","displayName":"Amazon Kinesis","workspaceFileName":"Amazon Kinesis Example"},{"url":"https://docs.databricks.com/_static/notebooks/cassandra.html","displayName":"Cassandra","workspaceFileName":"Cassandra Example"},{"url":"https://docs.databricks.com/_static/notebooks/structured-streaming-etl-kafka.html","displayName":"Kafka","workspaceFileName":"Kafka Example"},{"url":"https://docs.databricks.com/_static/notebooks/redis.html","displayName":"Redis","workspaceFileName":"Redis Example"},{"url":"https://docs.databricks.com/_static/notebooks/elasticsearch.html","displayName":"Elasticsearch","workspaceFileName":"Elasticsearch Example"}],"enableStaticNotebooks":true,"sandboxForUrlSandboxFrame":"allow-scripts allow-popups allow-popups-to-escape-sandbox allow-forms","enableCssTransitions":true,"serverlessEnableElasticDisk":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":true,"enableCreateClusterOnAttach":false,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"defaultMinWorkers":2,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"defaultMaxWorkers":8,"enableWorkspaceAclsConfig":false,"serverlessRunPythonAsLowPrivilegeUser":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":true,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"3.3.x-scala2.11","displayName":"3.3 (includes Apache Spark 2.2.0, Scala 2.11)","packageLabel":"spark-image-73a161da0570b3f51c8eb238602af2f5561789ea80b25c69a48691fc84e2d974","upgradable":true,"deprecated":false,"customerVisible":true,"capabilities":[]},"enableCustomSpotPricing":true,"enableMountAclsConfig":false,"defaultAutoterminationMin":120,"useDevTierHomePage":false,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableNotebookDatasetInfoView":true,"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","azurePortalLink":"https://portal.azure.com","cloud":"AWS","disallowAddingAdmins":false,"enableSparkConfUI":true,"featureTier":"STANDARD_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","enableOrgSwitcherUI":true,"bitbucketCloudBaseApiV2Url":"https://api.bitbucket.org/2.0","clustersLimit":-1,"enableJdbcImport":true,"enableElasticDisk":true,"logfiles":"logfiles/","enableRelativeNotebookLinks":true,"enableMultiSelect":true,"homePageLogo":"login/databricks_logoTM_rgb_TM.svg","enableWebappSharding":true,"enableNotebookParamsEdit":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"separateTableForJobClusters":true,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableMountAclService":true,"enableStructuredDataAcls":false,"showVersion":true,"serverlessClustersByDefault":false,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","databricksDocsNotebookPathPrefix":"^https://docs\\.databricks\\.com/_static/notebooks/.+$","serverlessAttachEbsVolumesByDefault":false,"enableTokensConfig":false,"allowFeedbackForumAccess":true,"enableImportFromUrl":true,"allowDisplayHtmlByUrl":false,"enableTokens":true,"enableMiniClusters":false,"enableNewJobList":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":false,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"loginLogo":"/login/databricks_logoTM_rgb_TM.svg","useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSpotClusterType":true,"enableSparkPackages":true,"checkAadUserInWorkspaceTenant":false,"dynamicSparkVersions":true,"useIframeForHtmlResult":false,"enableClusterTagsUIByTier":true,"enableNotebookHistoryUI":true,"enableClusterLoggingUI":true,"enableDatabaseDropdownInTableUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":true,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":true,"maxImportFileVersion":5,"enableEBSVolumesUIByTier":true,"singleSignOnComingSoon":false,"removeSubCommandCodeWhenExport":true,"upgradeURL":"","maxAutoterminationMinutes":10000,"autoterminateClustersByDefault":false,"notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":true,"showForgotPasswordLink":true,"defaultMemoryPerContainerMB":28000,"enablePresenceUI":true,"minAutoterminationMinutes":10,"accounts":true,"useOnDemandClustersByDefault":false,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"enableAutoCreateUserUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":true,"showSqlProxyUI":true,"enableNotebookErrorHighlighting":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":1614232568899824,"name":"nebaditn_HW3","language":"python","commands":[{"version":"CommandV1","origId":1523402910002272,"guid":"aaaff018-d485-49b6-86a7-f3e14a1da456","subtype":"command","commandType":"auto","position":1.0,"command":"#Homework3: Kaggle Home Depot\n#Submitted by: Nebadita Nayak\n#Date: 15th October 2017\n\n#The first step in my analysis is Data preparation: Load all the data from the csv files into the data frames\n\n#Loading the attributes\nfrom pyspark.ml.linalg import Vectors\ndf_attributes = sqlContext.read.format(\"csv\")\\\n                .option(\"header\",\"true\")\\\n                .option(\"inferSchema\",\"true\")\\\n                .load(\"dbfs:/FileStore/tables/f7lx0jmd1508085705380/attributes.csv\")\n\n#Loading the product_descriptions.csv\ndf_productDescription = sqlContext.read.format(\"csv\")\\\n                        .option(\"header\",\"true\")\\\n                        .option(\"inferSchema\",\"true\")\\\n                        .load(\"dbfs:/FileStore/tables/fow8q23y1508086436679/product_descriptions.csv\")\n#Loading the test.csv\ndf_test = sqlContext.read.format(\"csv\")\\\n                        .option(\"header\",\"true\")\\\n                        .option(\"inferSchema\",\"true\")\\\n                        .load(\"dbfs:/FileStore/tables/fow8q23y1508086436679/test.csv\")\n#Loading the train.csv\ndf_train = sqlContext.read.format(\"csv\")\\\n                        .option(\"header\",\"true\")\\\n                        .option(\"inferSchema\",\"true\")\\\n                        .load(\"dbfs:/FileStore/tables/fow8q23y1508086436679/train.csv\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">IndentationError</span><span class=\"ansired\">:</span> unexpected indent","error":null,"workflows":[],"startTime":1508515259101,"submitTime":1508515258687,"finishTime":1508515264229,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"46b6ea60-edca-47e8-a61a-82c8d89d3ebe"},{"version":"CommandV1","origId":1523402910002273,"guid":"5a4d93c8-b1d1-4d6f-8516-125ae2e0b492","subtype":"command","commandType":"auto","position":2.0,"command":"#Check the data in all the data ftames\nprint(df_train.count()) \ndf_attributes.show()\ndf_productDescription.show()\ndf_train.show()\ndf_test.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">74067\n+-----------+--------------------+--------------------+\n|product_uid|                name|               value|\n+-----------+--------------------+--------------------+\n|     100001|            Bullet01|Versatile connect...|\n|     100001|            Bullet02|Stronger than ang...|\n|     100001|            Bullet03|Help ensure joint...|\n|     100001|            Bullet04|Dimensions: 3 in....|\n|     100001|            Bullet05|Made from 12-Gaug...|\n|     100001|            Bullet06|Galvanized for ex...|\n|     100001|            Bullet07|Install with 10d ...|\n|     100001|               Gauge|                  12|\n|     100001|            Material|    Galvanized Steel|\n|     100001|      MFG Brand Name|  Simpson Strong-Tie|\n|     100001|    Number of Pieces|                   1|\n|     100001| Product Depth (in.)|                 1.5|\n|     100001|Product Height (in.)|                   3|\n|     100001|Product Weight (lb.)|                0.26|\n|     100001| Product Width (in.)|                   3|\n|     100002|  Application Method|  Brush,Roller,Spray|\n|     100002|Assembled Depth (...|             6.63 in|\n|     100002|Assembled Height ...|             7.76 in|\n|     100002|Assembled Width (...|             6.63 in|\n|     100002|            Bullet01|Revives wood and ...|\n+-----------+--------------------+--------------------+\nonly showing top 20 rows\n\n+-----------+--------------------+\n|product_uid| product_description|\n+-----------+--------------------+\n|     100001|&quot;Not only do angl...|\n|     100002|BEHR Premium Text...|\n|     100003|Classic architect...|\n|     100004|The Grape Solar 2...|\n|     100005|Update your bathr...|\n|     100006|Achieving delicio...|\n|     100007|The Quantum Adjus...|\n|     100008|The Teks #10 x 1-...|\n|     100009|Get the House of ...|\n|     100010|Valley View Indus...|\n|     100011|&quot;Recycler 22 in. ...|\n|     100012|The 96 in. wide C...|\n|     100013|The InSinkErator ...|\n|     100014|The Rubbermaid 1-...|\n|     100015|Backyard X-Scapes...|\n|     100016|Make grilling gre...|\n|     100017|The MD Building P...|\n|     100018|This classic plas...|\n|     100019|The House of Fara...|\n|     100020|These unique LED ...|\n+-----------+--------------------+\nonly showing top 20 rows\n\n+---+-----------+--------------------+--------------------+---------+\n| id|product_uid|       product_title|         search_term|relevance|\n+---+-----------+--------------------+--------------------+---------+\n|  2|     100001|Simpson Strong-Ti...|       angle bracket|      3.0|\n|  3|     100001|Simpson Strong-Ti...|           l bracket|      2.5|\n|  9|     100002|BEHR Premium Text...|           deck over|      3.0|\n| 16|     100005|Delta Vero 1-Hand...|    rain shower head|     2.33|\n| 17|     100005|Delta Vero 1-Hand...|  shower only faucet|     2.67|\n| 18|     100006|Whirlpool 1.9 cu....|      convection otr|      3.0|\n| 20|     100006|Whirlpool 1.9 cu....|microwave over stove|     2.67|\n| 21|     100006|Whirlpool 1.9 cu....|          microwaves|      3.0|\n| 23|     100007|Lithonia Lighting...|     emergency light|     2.67|\n| 27|     100009|House of Fara 3/4...|             mdf 3/4|      3.0|\n| 34|     100010|Valley View Indus...|        steele stake|     2.67|\n| 35|     100011|Toro Personal Pac...|briggs and stratt...|      3.0|\n| 37|     100011|Toro Personal Pac...|            gas mowe|      3.0|\n| 38|     100011|Toro Personal Pac...|         honda mower|      2.0|\n| 48|     100012|Hampton Bay Caram...|hampton bay chest...|     2.67|\n| 51|     100013|InSinkErator Sink...|            disposer|     2.67|\n| 65|     100016|Sunjoy Calais 8 f...|        grill gazebo|      3.0|\n| 69|     100017|MD Building Produ...|         door guards|      1.0|\n| 75|     100017|MD Building Produ...|metal plate cover...|     1.67|\n| 81|     100017|MD Building Produ...|      radiator grate|     2.33|\n+---+-----------+--------------------+--------------------+---------+\nonly showing top 20 rows\n\n+---+-----------+--------------------+--------------------+\n| id|product_uid|       product_title|         search_term|\n+---+-----------+--------------------+--------------------+\n|  1|     100001|Simpson Strong-Ti...|   90 degree bracket|\n|  4|     100001|Simpson Strong-Ti...|    metal l brackets|\n|  5|     100001|Simpson Strong-Ti...|    simpson sku able|\n|  6|     100001|Simpson Strong-Ti...|simpson strong  ties|\n|  7|     100001|Simpson Strong-Ti...|simpson strong ti...|\n|  8|     100001|Simpson Strong-Ti...|     wood connectors|\n| 10|     100003|STERLING Ensemble...| bath and shower kit|\n| 11|     100003|STERLING Ensemble...|      bath drain kit|\n| 12|     100003|STERLING Ensemble...|one piece tub shower|\n| 13|     100004|Grape Solar 265-W...|         solar panel|\n| 14|     100005|Delta Vero 1-Hand...|1 handle shower d...|\n| 15|     100005|Delta Vero 1-Hand...|delta ashland sho...|\n| 19|     100006|Whirlpool 1.9 cu....|       cooking stove|\n| 22|     100006|Whirlpool 1.9 cu....|microwaves over r...|\n| 24|     100008|Teks #10 1-1/2 in...| self tapping screws|\n| 25|     100009|House of Fara 3/4...|   3 1/20door casing|\n| 26|     100009|House of Fara 3/4...|           door trim|\n| 28|     100010|Valley View Indus...|       anchor stakes|\n| 29|     100010|Valley View Indus...|    landscape edging|\n| 30|     100010|Valley View Indus...|         lawn edging|\n+---+-----------+--------------------+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: cannot concatenate &apos;str&apos; and &apos;int&apos; objects","error":null,"workflows":[],"startTime":1508522488238,"submitTime":1508522487801,"finishTime":1508522489749,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"51274400-6279-48e2-8774-fd97508cb5c3"},{"version":"CommandV1","origId":1523402910002274,"guid":"39205b48-1450-4178-bf16-dc41136676aa","subtype":"command","commandType":"auto","position":3.0,"command":"import pyspark.sql.functions as F\nfrom pyspark.sql.types import *\n## Now we will prepare data for our analysis\n#Concatenate train data with the product description\ndf_train_modified = df_train.join(df_productDescription, on=\"product_uid\", how=\"left\")\ndf_train_modified.sort(\"id\")\n#print(df_train_modified.count())\n#df_train_modified.show()\n#similarly we will get the modified version of test data by appending the product description column\ndf_test_modified = df_test.join(df_productDescription,on=\"product_uid\",how=\"left\")\n#print(df_test_modified.count())\n#df_test_modified.show()\n#df_attributes.show()\n#Get the brand of each of the Product ID\nBrands = df_attributes[df_attributes['name']==\"MFG Brand Name\"]\n#Get the bullets\n#print(Brands.count())\nBullets = df_attributes[df_attributes[\"name\"].contains(\"Bullet\")]\n#Brands.show()\nBrands.sort(\"product_uid\")\nBullets.sort(\"product_uid\")\n#Bullets.show()\n#BulletPandas = Bullets.toPandas()\n#BulletPandas = BulletPandas.unstack(col = [\"name\", \"value\"], new_column_name = \"bullets\")\n#print(BulletPandas)\n#Join the brand name with the \ndf_train_modified=df_train_modified.join(Brands, on=\"product_uid\", how=\"left\")\n\n#print(df_train_modified.count())\ndf_train_modified = df_train_modified.selectExpr(\"id\",\"product_uid\",\"product_title\",\"search_term\",\"relevance\",\"product_description\",\"value as Brand\")\ndf_train_modified.sort(\"id\")\n#df_train_modified.show()\n\ndf_test_modified=df_test_modified.join(Brands, on=\"product_uid\", how=\"left\")\ndf_test_modified = df_test_modified.selectExpr(\"id\",\"product_uid\",\"product_title\",\"search_term\",\"product_description\",\"value as Brand\")\ndf_test_modified.sort(\"id\")\n\n#UDF to concatenate two columns\nconcat_udf = F.udf(lambda cols: \"\".join([x if x is not None else \"*\" for x in cols]), StringType())\ndf_train_modified=df_train_modified.withColumn(\"product_description_new\", concat_udf(F.array(\"Brand\", \"product_description\")))\ndf_test_modified=df_test_modified.withColumn(\"product_description_new\", concat_udf(F.array(\"Brand\", \"product_description\")))\n\n#df_test_modified.show()\n#df_train_modified.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;StringType&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-1523402910002274&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     36</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     37</span> <span class=\"ansired\">#UDF to concatenate two columns</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 38</span><span class=\"ansiyellow\"> </span>concat_udf <span class=\"ansiyellow\">=</span> F<span class=\"ansiyellow\">.</span>udf<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> cols<span class=\"ansiyellow\">:</span> <span class=\"ansiblue\">&quot;&quot;</span><span class=\"ansiyellow\">.</span>join<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span>x <span class=\"ansigreen\">if</span> x <span class=\"ansigreen\">is</span> <span class=\"ansigreen\">not</span> None <span class=\"ansigreen\">else</span> <span class=\"ansiblue\">&quot;*&quot;</span> <span class=\"ansigreen\">for</span> x <span class=\"ansigreen\">in</span> cols<span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> StringType<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     39</span> df_train_modified<span class=\"ansiyellow\">=</span>df_train_modified<span class=\"ansiyellow\">.</span>withColumn<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;product_description_new&quot;</span><span class=\"ansiyellow\">,</span> concat_udf<span class=\"ansiyellow\">(</span>F<span class=\"ansiyellow\">.</span>array<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Brand&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;product_description&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     40</span> df_test_modified<span class=\"ansiyellow\">=</span>df_test_modified<span class=\"ansiyellow\">.</span>withColumn<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;product_description_new&quot;</span><span class=\"ansiyellow\">,</span> concat_udf<span class=\"ansiyellow\">(</span>F<span class=\"ansiyellow\">.</span>array<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Brand&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;product_description&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;StringType&apos; is not defined</div>","workflows":[],"startTime":1508515266045,"submitTime":1508515259748,"finishTime":1508515266225,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"14627445-ee66-4298-a0f0-b07db23b1581"},{"version":"CommandV1","origId":1523402910002275,"guid":"f2519b01-db75-4da4-a7fd-9c6ed60c0b50","subtype":"command","commandType":"auto","position":4.0,"command":"#In this module, we will try to implement TF-IDF\nfrom pyspark.ml.feature import HashingTF\nfrom pyspark.ml.feature import IDF\nfrom pyspark.ml.feature import Tokenizer\nfrom pyspark.ml import pipeline\nfrom pyspark.mllib.tree import RandomForest, RandomForestModel\nfrom pyspark.mllib.tree import GradientBoostedTrees, GradientBoostedTreesModel\nfrom pyspark.mllib.util import MLUtils\nfrom pyspark.mllib.regression import LabeledPoint\ntokenizer = Tokenizer(inputCol=\"product_description_new\",outputCol=\"words\")\nwordsData = tokenizer.transform(df_train_modified)\nhashingTF = HashingTF(inputCol=\"words\",outputCol=\"rawFeatures\",numFeatures=20)\nfeaturizedData = hashingTF.transform(wordsData)\n#featurizedData.show()\nidf = IDF(inputCol=\"rawFeatures\",outputCol=\"features\")\nidfModel = idf.fit(featurizedData)\nrescaleData = idfModel.transform(featurizedData)\n\n#rescaleData.show()\n#model = RandomForest.trainRegressor(rescaleData, categoricalFeaturesInfo={}, numTrees=10, featureSubsetStrategy=\"auto\", impurity='variance', maxDepth=10, maxBins=100)\n#model = GradientBoostedTrees.trainRegressor(rescaleData,categoricalFeaturesInfo={}, numIterations=10)\n\nwordsDataTest = tokenizer.transform(df_test_modified)\nfeaturizedDataTest = hashingTF.transform(wordsDataTest)\nidfModelTest = idf.fit(featurizedDataTest)\nrescaleDataTest = idfModel.transform(featurizedDataTest)\nrescaleDataTest.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+-----------+--------------------+--------------------+--------------------+------------+-----------------------+--------------------+--------------------+--------------------+\n|  id|product_uid|       product_title|         search_term| product_description|       Brand|product_description_new|               words|         rawFeatures|            features|\n+----+-----------+--------------------+--------------------+--------------------+------------+-----------------------+--------------------+--------------------+--------------------+\n|1016|     100170|Dyna-Glo Pro 125,...|   gas garage heater|Dyna-Glo Pro port...|Dyna-Glo Pro|   Dyna-Glo ProDyna-...|[dyna-glo, prodyn...|(20,[0,2,3,4,5,7,...|(20,[0,2,3,4,5,7,...|\n|1017|     100170|Dyna-Glo Pro 125,...|  gas garage heaters|Dyna-Glo Pro port...|Dyna-Glo Pro|   Dyna-Glo ProDyna-...|[dyna-glo, prodyn...|(20,[0,2,3,4,5,7,...|(20,[0,2,3,4,5,7,...|\n|1018|     100170|Dyna-Glo Pro 125,...|          heater gas|Dyna-Glo Pro port...|Dyna-Glo Pro|   Dyna-Glo ProDyna-...|[dyna-glo, prodyn...|(20,[0,2,3,4,5,7,...|(20,[0,2,3,4,5,7,...|\n|1021|     100170|Dyna-Glo Pro 125,...|lp gas space heaters|Dyna-Glo Pro port...|Dyna-Glo Pro|   Dyna-Glo ProDyna-...|[dyna-glo, prodyn...|(20,[0,2,3,4,5,7,...|(20,[0,2,3,4,5,7,...|\n|1023|     100170|Dyna-Glo Pro 125,...| portable gas heater|Dyna-Glo Pro port...|Dyna-Glo Pro|   Dyna-Glo ProDyna-...|[dyna-glo, prodyn...|(20,[0,2,3,4,5,7,...|(20,[0,2,3,4,5,7,...|\n|1024|     100170|Dyna-Glo Pro 125,...|propane gas tank ...|Dyna-Glo Pro port...|Dyna-Glo Pro|   Dyna-Glo ProDyna-...|[dyna-glo, prodyn...|(20,[0,2,3,4,5,7,...|(20,[0,2,3,4,5,7,...|\n|1025|     100170|Dyna-Glo Pro 125,...|propane torpedo h...|Dyna-Glo Pro port...|Dyna-Glo Pro|   Dyna-Glo ProDyna-...|[dyna-glo, prodyn...|(20,[0,2,3,4,5,7,...|(20,[0,2,3,4,5,7,...|\n|1027|     100170|Dyna-Glo Pro 125,...|ventenatural gas ...|Dyna-Glo Pro port...|Dyna-Glo Pro|   Dyna-Glo ProDyna-...|[dyna-glo, prodyn...|(20,[0,2,3,4,5,7,...|(20,[0,2,3,4,5,7,...|\n|1574|     100274|Milwaukee M12 12-...|         battery 12v|Milwaukee REDLITH...|   Milwaukee|   MilwaukeeMilwauke...|[milwaukeemilwauk...|(20,[0,1,2,4,5,6,...|(20,[0,1,2,4,5,6,...|\n|1575|     100274|Milwaukee M12 12-...|dill battery 12v ...|Milwaukee REDLITH...|   Milwaukee|   MilwaukeeMilwauke...|[milwaukeemilwauk...|(20,[0,1,2,4,5,6,...|(20,[0,1,2,4,5,6,...|\n|2530|     100446|Glacier Bay 2-pie...|bankoft toilet bi...|Choose a half flu...| Glacier Bay|   Glacier BayChoose...|[glacier, baychoo...|(20,[0,1,2,3,4,5,...|(20,[0,1,2,3,4,5,...|\n|2531|     100446|Glacier Bay 2-pie...|        beige toilet|Choose a half flu...| Glacier Bay|   Glacier BayChoose...|[glacier, baychoo...|(20,[0,1,2,3,4,5,...|(20,[0,1,2,3,4,5,...|\n|2532|     100446|Glacier Bay 2-pie...|              bolens|Choose a half flu...| Glacier Bay|   Glacier BayChoose...|[glacier, baychoo...|(20,[0,1,2,3,4,5,...|(20,[0,1,2,3,4,5,...|\n|2533|     100446|Glacier Bay 2-pie...|   dual flush toilet|Choose a half flu...| Glacier Bay|   Glacier BayChoose...|[glacier, baychoo...|(20,[0,1,2,3,4,5,...|(20,[0,1,2,3,4,5,...|\n|2536|     100446|Glacier Bay 2-pie...|        high toilets|Choose a half flu...| Glacier Bay|   Glacier BayChoose...|[glacier, baychoo...|(20,[0,1,2,3,4,5,...|(20,[0,1,2,3,4,5,...|\n|2537|     100446|Glacier Bay 2-pie...|   toilet bowls high|Choose a half flu...| Glacier Bay|   Glacier BayChoose...|[glacier, baychoo...|(20,[0,1,2,3,4,5,...|(20,[0,1,2,3,4,5,...|\n|4620|     100800|Seal-Krete Epoxy ...|             coating|Seal-Krete Epoxy ...|  Seal-Krete|   Seal-KreteSeal-Kr...|[seal-kreteseal-k...|(20,[0,1,2,3,4,5,...|(20,[0,1,2,3,4,5,...|\n|4622|     100800|Seal-Krete Epoxy ...|epoxy garage floo...|Seal-Krete Epoxy ...|  Seal-Krete|   Seal-KreteSeal-Kr...|[seal-kreteseal-k...|(20,[0,1,2,3,4,5,...|(20,[0,1,2,3,4,5,...|\n|4623|     100800|Seal-Krete Epoxy ...|         floor paint|Seal-Krete Epoxy ...|  Seal-Krete|   Seal-KreteSeal-Kr...|[seal-kreteseal-k...|(20,[0,1,2,3,4,5,...|(20,[0,1,2,3,4,5,...|\n|4624|     100800|Seal-Krete Epoxy ...|        floor sealer|Seal-Krete Epoxy ...|  Seal-Krete|   Seal-KreteSeal-Kr...|[seal-kreteseal-k...|(20,[0,1,2,3,4,5,...|(20,[0,1,2,3,4,5,...|\n+----+-----------+--------------------+--------------------+--------------------+------------+-----------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;df_train_modified&apos; is not defined","error":null,"workflows":[],"startTime":1508515266228,"submitTime":1508515260323,"finishTime":1508515275471,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"19d96ad1-483c-4bd5-ae6d-2956ed672404"},{"version":"CommandV1","origId":1523402910002276,"guid":"c7f3d629-1e46-4f0a-9210-390da0f550b4","subtype":"command","commandType":"auto","position":5.0,"command":"#Calculate the TF-IDF for the search term\ntokenizer1 = Tokenizer(inputCol=\"search_term\",outputCol=\"Searchwords\")\nwordsData1 = tokenizer1.transform(rescaleData)\nhashingTF1 = HashingTF(inputCol=\"Searchwords\",outputCol=\"rawSearchTermFeatures\",numFeatures=20)\nfeaturizedData1 = hashingTF1.transform(wordsData1)\nidf1 = IDF(inputCol=\"rawSearchTermFeatures\",outputCol=\"searchWordFeatures\")\nidfModel1 = idf1.fit(featurizedData1).transform(featurizedData1)\n#rescaleData1.show()\nworkingData = idfModel1.select(\"product_uid\",\"relevance\",\"searchWordFeatures\",\"features\")\n# This data frame contains product,ID, relevance, TF-IDF of search term and TF-IDF of the product description\nworkingData.show()\n#Now we will find the cosine distance between searchWordFeatures and features\n\n#Calculate search term TF-IDF for test data\nwordsDataTest1 = tokenizer1.transform(rescaleDataTest)\nfeaturizedDataTest1 = hashingTF1.transform(wordsDataTest1)\nidfModelTest1 = idf1.fit(featurizedDataTest1).transform(featurizedDataTest1)\nworkingDataTest = idfModelTest1.select(\"id\",\"product_uid\",\"searchWordFeatures\",\"features\")\nworkingDataTest.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------+---------+--------------------+--------------------+\n|product_uid|relevance|  searchWordFeatures|            features|\n+-----------+---------+--------------------+--------------------+\n|     100170|      1.0|(20,[10,18],[1.79...|(20,[0,2,3,4,5,7,...|\n|     100170|     2.67|(20,[9,12,15],[1....|(20,[0,2,3,4,5,7,...|\n|     100170|     1.67|(20,[3,7,14],[1.9...|(20,[0,2,3,4,5,7,...|\n|     100170|     2.33|(20,[2,7,10],[2.0...|(20,[0,2,3,4,5,7,...|\n|     100274|      3.0|(20,[4,6],[1.9857...|(20,[0,1,2,4,5,6,...|\n|     100274|     1.67|(20,[6,10],[2.036...|(20,[0,1,2,4,5,6,...|\n|     100274|     1.67|(20,[2,4,10],[2.0...|(20,[0,1,2,4,5,6,...|\n|     100446|     2.67|(20,[1,11,19],[1....|(20,[0,1,2,3,4,5,...|\n|     100446|     1.67|(20,[1,7,16,19],[...|(20,[0,1,2,3,4,5,...|\n|     100446|      3.0|(20,[1,19],[1.958...|(20,[0,1,2,3,4,5,...|\n|     100446|      3.0|(20,[5,6,9],[2.22...|(20,[0,1,2,3,4,5,...|\n|     100800|      2.0|(20,[2,3,15,16],[...|(20,[0,1,2,3,4,5,...|\n|     100986|      1.0|(20,[1],[1.958573...|(20,[0,1,2,3,4,5,...|\n|     101055|      2.0|(20,[0,10,16],[1....|(20,[0,1,2,3,4,5,...|\n|     101055|     2.67|(20,[10,16],[5.37...|(20,[0,1,2,3,4,5,...|\n|     101055|     1.67|(20,[16,19],[1.86...|(20,[0,1,2,3,4,5,...|\n|     101055|     2.67|(20,[9,13,14],[1....|(20,[0,1,2,3,4,5,...|\n|     101055|     2.33|(20,[9],[3.730497...|(20,[0,1,2,3,4,5,...|\n|     101055|     1.67|(20,[15,17],[1.89...|(20,[0,1,2,3,4,5,...|\n|     101094|     2.33|(20,[4,8,12,13,14...|(20,[0,1,2,3,4,5,...|\n+-----------+---------+--------------------+--------------------+\nonly showing top 20 rows\n\n+----+-----------+--------------------+--------------------+\n|  id|product_uid|  searchWordFeatures|            features|\n+----+-----------+--------------------+--------------------+\n|1016|     100170|(20,[10,14,15],[1...|(20,[0,2,3,4,5,7,...|\n|1017|     100170|(20,[9,14,15],[1....|(20,[0,2,3,4,5,7,...|\n|1018|     100170|(20,[10,15],[1.84...|(20,[0,2,3,4,5,7,...|\n|1021|     100170|(20,[7,9,12,15],[...|(20,[0,2,3,4,5,7,...|\n|1023|     100170|(20,[3,10,15],[2....|(20,[0,2,3,4,5,7,...|\n|1024|     100170|(20,[2,4,7,15],[2...|(20,[0,2,3,4,5,7,...|\n|1025|     100170|(20,[2,7,10],[2.1...|(20,[0,2,3,4,5,7,...|\n|1027|     100170|(20,[10,12,15],[1...|(20,[0,2,3,4,5,7,...|\n|1574|     100274|(20,[4,9],[2.0614...|(20,[0,1,2,4,5,6,...|\n|1575|     100274|(20,[4,7,9,17],[2...|(20,[0,1,2,4,5,6,...|\n|2530|     100446|(20,[6,18,19],[2....|(20,[0,1,2,3,4,5,...|\n|2531|     100446|(20,[19],[3.56576...|(20,[0,1,2,3,4,5,...|\n|2532|     100446|(20,[8],[2.275270...|(20,[0,1,2,3,4,5,...|\n|2533|     100446|(20,[0,13,19],[1....|(20,[0,1,2,3,4,5,...|\n|2536|     100446|(20,[9,16],[1.872...|(20,[0,1,2,3,4,5,...|\n|2537|     100446|(20,[16,19],[3.87...|(20,[0,1,2,3,4,5,...|\n|4620|     100800|(20,[3],[2.002644...|(20,[0,1,2,3,4,5,...|\n|4622|     100800|(20,[2,3,4,14],[2...|(20,[0,1,2,3,4,5,...|\n|4623|     100800|(20,[2,3],[2.1160...|(20,[0,1,2,3,4,5,...|\n|4624|     100800|(20,[2,3],[2.1160...|(20,[0,1,2,3,4,5,...|\n+----+-----------+--------------------+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> unexpected character after line continuation character","error":null,"workflows":[],"startTime":1508522590906,"submitTime":1508522590837,"finishTime":1508522597650,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5e1b7267-67df-4708-aebb-8fc28bf8b546"},{"version":"CommandV1","origId":1523402910002277,"guid":"8bfe5798-bdc1-4f85-98f5-b1f9652cb39e","subtype":"command","commandType":"auto","position":6.0,"command":"from pyspark.mllib.util import MLUtils\nfrom pyspark.ml.feature import Normalizer\n\n#Normalize search term and description vectors in Train\n\nnormalizer1 = Normalizer(inputCol=\"searchWordFeatures\", outputCol=\"searchWordNorm\",p=1.0)\nl1NormData1 = normalizer1.transform(workingData)\nnormalizer2 = Normalizer(inputCol=\"features\", outputCol=\"featureNorm\",p=1.0)\nl1NormData2 = normalizer2.transform(l1NormData1)\nworkingData2 =l1NormData2.select(\"product_uid\",\"relevance\",\"searchWordNorm\",\"featureNorm\")\n#workingData2.show()\n\n#Normalize search term and description vectors in Test\nl1NormDataTest1 = normalizer1.transform(workingDataTest)\nl1NormDataTest2 = normalizer2.transform(l1NormDataTest1)\nworkingDataTest2 = l1NormDataTest2.select(\"id\",\"product_uid\",\"searchWordNorm\",\"featureNorm\")\nworkingDataTest2.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+-----------+--------------------+--------------------+\n|  id|product_uid|      searchWordNorm|         featureNorm|\n+----+-----------+--------------------+--------------------+\n|1016|     100170|(20,[10,14,15],[0...|(20,[0,2,3,4,5,7,...|\n|1017|     100170|(20,[9,14,15],[0....|(20,[0,2,3,4,5,7,...|\n|1018|     100170|(20,[10,15],[0.48...|(20,[0,2,3,4,5,7,...|\n|1021|     100170|(20,[7,9,12,15],[...|(20,[0,2,3,4,5,7,...|\n|1023|     100170|(20,[3,10,15],[0....|(20,[0,2,3,4,5,7,...|\n|1024|     100170|(20,[2,4,7,15],[0...|(20,[0,2,3,4,5,7,...|\n|1025|     100170|(20,[2,7,10],[0.3...|(20,[0,2,3,4,5,7,...|\n|1027|     100170|(20,[10,12,15],[0...|(20,[0,2,3,4,5,7,...|\n|1574|     100274|(20,[4,9],[0.5240...|(20,[0,1,2,4,5,6,...|\n|1575|     100274|(20,[4,7,9,17],[0...|(20,[0,1,2,4,5,6,...|\n|2530|     100446|(20,[6,18,19],[0....|(20,[0,1,2,3,4,5,...|\n|2531|     100446|     (20,[19],[1.0])|(20,[0,1,2,3,4,5,...|\n|2532|     100446|      (20,[8],[1.0])|(20,[0,1,2,3,4,5,...|\n|2533|     100446|(20,[0,13,19],[0....|(20,[0,1,2,3,4,5,...|\n|2536|     100446|(20,[9,16],[0.491...|(20,[0,1,2,3,4,5,...|\n|2537|     100446|(20,[16,19],[0.68...|(20,[0,1,2,3,4,5,...|\n|4620|     100800|      (20,[3],[1.0])|(20,[0,1,2,3,4,5,...|\n|4622|     100800|(20,[2,3,4,14],[0...|(20,[0,1,2,3,4,5,...|\n|4623|     100800|(20,[2,3],[0.5137...|(20,[0,1,2,3,4,5,...|\n|4624|     100800|(20,[2,3],[0.5137...|(20,[0,1,2,3,4,5,...|\n+----+-----------+--------------------+--------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&quot;cannot resolve &apos;&#96;relevance&#96;&apos; given input columns: [features, featureNorm, searchWordFeatures, searchWordNorm, product_uid];;\\n&apos;Project [product_uid#110, &apos;relevance, searchWordNorm#171334, featureNorm#171340]\\n+- Project [product_uid#110, searchWordFeatures#171285, features#170916, searchWordNorm#171334, UDF(features#170916) AS featureNorm#171340]\\n   +- Project [product_uid#110, searchWordFeatures#171285, features#170916, UDF(searchWordFeatures#171285) AS searchWordNorm#171334]\\n      +- Project [product_uid#110, searchWordFeatures#171285, features#170916]\\n         +- Project [id#109, product_uid#110, product_title#111, search_term#112, product_description#93, Brand#299, words#170889, rawFeatures#170898, features#170916, Searchwords#171252, rawSearchTermFeatures#171264, UDF(rawSearchTermFeatures#171264) AS searchWordFeatures#171285]\\n            +- Project [id#109, product_uid#110, product_title#111, search_term#112, product_description#93, Brand#299, words#170889, rawFeatures#170898, features#170916, Searchwords#171252, UDF(Searchwords#171252) AS rawSearchTermFeatures#171264]\\n               +- Project [id#109, product_uid#110, product_title#111, search_term#112, product_description#93, Brand#299, words#170889, rawFeatures#170898, features#170916, UDF(search_term#112) AS Searchwords#171252]\\n                  +- Project [id#109, product_uid#110, product_title#111, search_term#112, product_description#93, Brand#299, words#170889, rawFeatures#170898, UDF(rawFeatures#170898) AS features#170916]\\n                     +- Project [id#109, product_uid#110, product_title#111, search_term#112, product_description#93, Brand#299, words#170889, UDF(words#170889) AS rawFeatures#170898]\\n                        +- Project [id#109, product_uid#110, product_title#111, search_term#112, product_description#93, Brand#299, UDF(product_description#93) AS words#170889]\\n                           +- Project [id#109, product_uid#110, product_title#111, search_term#112, product_description#93, value#65 AS Brand#299]\\n                              +- Project [product_uid#110, id#109, product_title#111, search_term#112, product_description#93, name#64, value#65]\\n                                 +- Join LeftOuter, (product_uid#110 = product_uid#63)\\n                                    :- Project [product_uid#110, id#109, product_title#111, search_term#112, product_description#93]\\n                                    :  +- Join LeftOuter, (product_uid#110 = product_uid#92)\\n                                    :     :- Relation[id#109,product_uid#110,product_title#111,search_term#112] csv\\n                                    :     +- Relation[product_uid#92,product_description#93] csv\\n                                    +- Filter (name#64 = MFG Brand Name)\\n                                       +- Relation[product_uid#63,name#64,value#65] csv\\n&quot;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-1614232568900279&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     14</span> l1NormDataTest1 <span class=\"ansiyellow\">=</span> normalizer1<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>workingDataTest<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     15</span> l1NormDataTest2 <span class=\"ansiyellow\">=</span> normalizer2<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>l1NormDataTest1<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 16</span><span class=\"ansiyellow\"> </span>workingDataTest2 <span class=\"ansiyellow\">=</span> l1NormDataTest2<span class=\"ansiyellow\">.</span>select<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;product_uid&quot;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&quot;relevance&quot;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&quot;searchWordNorm&quot;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&quot;featureNorm&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     17</span> workingDataTest2<span class=\"ansiyellow\">.</span>show<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.pyc</span> in <span class=\"ansicyan\">select</span><span class=\"ansiblue\">(self, *cols)</span>\n<span class=\"ansigreen\">   1039</span>         <span class=\"ansiyellow\">[</span>Row<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;Alice&apos;</span><span class=\"ansiyellow\">,</span> age<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">12</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;Bob&apos;</span><span class=\"ansiyellow\">,</span> age<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">15</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1040</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">-&gt; 1041</span><span class=\"ansiyellow\">         </span>jdf <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>select<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jcols<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>cols<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1042</span>         <span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>jdf<span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>sql_ctx<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1043</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&quot;cannot resolve &apos;&#96;relevance&#96;&apos; given input columns: [features, featureNorm, searchWordFeatures, searchWordNorm, product_uid];;\\n&apos;Project [product_uid#110, &apos;relevance, searchWordNorm#171334, featureNorm#171340]\\n+- Project [product_uid#110, searchWordFeatures#171285, features#170916, searchWordNorm#171334, UDF(features#170916) AS featureNorm#171340]\\n   +- Project [product_uid#110, searchWordFeatures#171285, features#170916, UDF(searchWordFeatures#171285) AS searchWordNorm#171334]\\n      +- Project [product_uid#110, searchWordFeatures#171285, features#170916]\\n         +- Project [id#109, product_uid#110, product_title#111, search_term#112, product_description#93, Brand#299, words#170889, rawFeatures#170898, features#170916, Searchwords#171252, rawSearchTermFeatures#171264, UDF(rawSearchTermFeatures#171264) AS searchWordFeatures#171285]\\n            +- Project [id#109, product_uid#110, product_title#111, search_term#112, product_description#93, Brand#299, words#170889, rawFeatures#170898, features#170916, Searchwords#171252, UDF(Searchwords#171252) AS rawSearchTermFeatures#171264]\\n               +- Project [id#109, product_uid#110, product_title#111, search_term#112, product_description#93, Brand#299, words#170889, rawFeatures#170898, features#170916, UDF(search_term#112) AS Searchwords#171252]\\n                  +- Project [id#109, product_uid#110, product_title#111, search_term#112, product_description#93, Brand#299, words#170889, rawFeatures#170898, UDF(rawFeatures#170898) AS features#170916]\\n                     +- Project [id#109, product_uid#110, product_title#111, search_term#112, product_description#93, Brand#299, words#170889, UDF(words#170889) AS rawFeatures#170898]\\n                        +- Project [id#109, product_uid#110, product_title#111, search_term#112, product_description#93, Brand#299, UDF(product_description#93) AS words#170889]\\n                           +- Project [id#109, product_uid#110, product_title#111, search_term#112, product_description#93, value#65 AS Brand#299]\\n                              +- Project [product_uid#110, id#109, product_title#111, search_term#112, product_description#93, name#64, value#65]\\n                                 +- Join LeftOuter, (product_uid#110 = product_uid#63)\\n                                    :- Project [product_uid#110, id#109, product_title#111, search_term#112, product_description#93]\\n                                    :  +- Join LeftOuter, (product_uid#110 = product_uid#92)\\n                                    :     :- Relation[id#109,product_uid#110,product_title#111,search_term#112] csv\\n                                    :     +- Relation[product_uid#92,product_description#93] csv\\n                                    +- Filter (name#64 = MFG Brand Name)\\n                                       +- Relation[product_uid#63,name#64,value#65] csv\\n&quot;</div>","workflows":[],"startTime":1508522631414,"submitTime":1508522631346,"finishTime":1508522632925,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"91f5617a-05a0-44a4-8fe9-9fb223685e3a"},{"version":"CommandV1","origId":1523402910002278,"guid":"f969f8d0-ec1a-448a-87ba-66a707f067c0","subtype":"command","commandType":"auto","position":7.0,"command":"#In this section, we calculate the cosine distance between two normalized vectors\nfrom sklearn.metrics.pairwise import cosine_similarity\n#from pyspark.mllib.linalg import Vectors, VectorUDT\nfrom pyspark.ml.linalg import Vectors\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import *\n#workingData2.show()\nsample2 = workingData2.rdd.map(lambda x:(x[0],x[1],x[2],x[3],Vectors.dense(cosine_similarity(x[2],x[3]))))\n#sample2 = workingData2.rdd.map(lambda x:(x[0],x[1],x[2],x[3],float(cosine_similarity(x[2],x[3]))))\ndfSample = sample2.toDF()\n#dfSample = udf(lambda x: DenseVector([1 - x, x]), VectorUDT())\ndfSample = dfSample.selectExpr(\"_1 as product_uid\",\"_2 as label\",\"_3 as searchWordNorm\",\"_4 as featureNorm\", \"_5 as cosine_distance\")\ndfSample.count()\ndfSample.show()\n\n#Transform test data\nsampleTest2 = workingDataTest2.rdd.map(lambda x:(x[0],x[1],x[2],x[3],Vectors.dense(cosine_similarity(x[2],x[3]))))\ndfSampleTest = sampleTest2.toDF()\ndfSampleTest = dfSampleTest.selectExpr(\"_1 as id\",\"_2 as product_uid\",\"_3 as searchWordNorm\",\"_4 as featureNorm\", \"_5 as cosine_distance\")\ndfSampleTest.show()\ndfSampleTest.count()\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------+-----+--------------------+--------------------+--------------------+\n|product_uid|label|      searchWordNorm|         featureNorm|     cosine_distance|\n+-----------+-----+--------------------+--------------------+--------------------+\n|     100170|  1.0|(20,[10,18],[0.47...|(20,[0,2,3,4,5,7,...|[0.16006294797433...|\n|     100170| 2.67|(20,[9,12,15],[0....|(20,[0,2,3,4,5,7,...|[0.5523339833192151]|\n|     100170| 1.67|(20,[3,7,14],[0.3...|(20,[0,2,3,4,5,7,...|[0.4644555055299677]|\n|     100170| 2.33|(20,[2,7,10],[0.3...|(20,[0,2,3,4,5,7,...|[0.3083289732152612]|\n|     100274|  3.0|(20,[4,6],[0.4936...|(20,[0,1,2,4,5,6,...|[0.49304993395300...|\n|     100274| 1.67|(20,[6,10],[0.532...|(20,[0,1,2,4,5,6,...|[0.35498358519186...|\n|     100274| 1.67|(20,[2,4,10],[0.2...|(20,[0,1,2,4,5,6,...|[0.24815883451273...|\n|     100446| 2.67|(20,[1,11,19],[0....|(20,[0,1,2,3,4,5,...|[0.34198152428409...|\n|     100446| 1.67|(20,[1,7,16,19],[...|(20,[0,1,2,3,4,5,...|[0.3642912384237322]|\n|     100446|  3.0|(20,[1,19],[0.358...|(20,[0,1,2,3,4,5,...|[0.29656350830202...|\n|     100446|  3.0|(20,[5,6,9],[0.36...|(20,[0,1,2,3,4,5,...|[0.4904099831888476]|\n|     100800|  2.0|(20,[2,3,15,16],[...|(20,[0,1,2,3,4,5,...|[0.21701854875200...|\n|     100986|  1.0|      (20,[1],[1.0])|(20,[0,1,2,3,4,5,...|[0.01207128482108...|\n|     101055|  2.0|(20,[0,10,16],[0....|(20,[0,1,2,3,4,5,...|[0.08690553005506...|\n|     101055| 2.67|(20,[10,16],[0.74...|(20,[0,1,2,3,4,5,...|[0.06966135901358...|\n|     101055| 1.67|(20,[16,19],[0.51...|(20,[0,1,2,3,4,5,...|[0.19739382005241...|\n|     101055| 2.67|(20,[9,13,14],[0....|(20,[0,1,2,3,4,5,...|[0.27826798615840...|\n|     101055| 2.33|      (20,[9],[1.0])|(20,[0,1,2,3,4,5,...|[0.35139771501201...|\n|     101055| 1.67|(20,[15,17],[0.48...|(20,[0,1,2,3,4,5,...| [0.256212157439884]|\n|     101094| 2.33|(20,[4,8,12,13,14...|(20,[0,1,2,3,4,5,...|[0.4821188085487793]|\n+-----------+-----+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n+----+-----------+--------------------+--------------------+--------------------+\n|  id|product_uid|      searchWordNorm|         featureNorm|     cosine_distance|\n+----+-----------+--------------------+--------------------+--------------------+\n|1016|     100170|(20,[10,14,15],[0...|(20,[0,2,3,4,5,7,...|[0.4614612421938943]|\n|1017|     100170|(20,[9,14,15],[0....|(20,[0,2,3,4,5,7,...| [0.681084096426029]|\n|1018|     100170|(20,[10,15],[0.48...|(20,[0,2,3,4,5,7,...|[0.2687549601071701]|\n|1021|     100170|(20,[7,9,12,15],[...|(20,[0,2,3,4,5,7,...|[0.6350638442090678]|\n|1023|     100170|(20,[3,10,15],[0....|(20,[0,2,3,4,5,7,...|[0.2637271933904835]|\n|1024|     100170|(20,[2,4,7,15],[0...|(20,[0,2,3,4,5,7,...|[0.4570861974714936]|\n|1025|     100170|(20,[2,7,10],[0.3...|(20,[0,2,3,4,5,7,...| [0.309078024456351]|\n|1027|     100170|(20,[10,12,15],[0...|(20,[0,2,3,4,5,7,...|[0.3312499272216736]|\n|1574|     100274|(20,[4,9],[0.5240...|(20,[0,1,2,4,5,6,...|[0.2392481075855748]|\n|1575|     100274|(20,[4,7,9,17],[0...|(20,[0,1,2,4,5,6,...| [0.521136551878792]|\n|2530|     100446|(20,[6,18,19],[0....|(20,[0,1,2,3,4,5,...|[0.38110765105559...|\n|2531|     100446|     (20,[19],[1.0])|(20,[0,1,2,3,4,5,...|[0.2664686386623577]|\n|2532|     100446|      (20,[8],[1.0])|(20,[0,1,2,3,4,5,...|[0.08702268832865...|\n|2533|     100446|(20,[0,13,19],[0....|(20,[0,1,2,3,4,5,...|[0.34316749458926...|\n|2536|     100446|(20,[9,16],[0.491...|(20,[0,1,2,3,4,5,...|[0.3307336407759833]|\n|2537|     100446|(20,[16,19],[0.68...|(20,[0,1,2,3,4,5,...|  [0.18768691734847]|\n|4620|     100800|      (20,[3],[1.0])|(20,[0,1,2,3,4,5,...|[0.12461109463137...|\n|4622|     100800|(20,[2,3,4,14],[0...|(20,[0,1,2,3,4,5,...|[0.2807333529712484]|\n|4623|     100800|(20,[2,3],[0.5137...|(20,[0,1,2,3,4,5,...|[0.1619614457947673]|\n|4624|     100800|(20,[2,3],[0.5137...|(20,[0,1,2,3,4,5,...|[0.1619614457947673]|\n+----+-----------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n<span class=\"ansired\">Out[</span><span class=\"ansired\">115</span><span class=\"ansired\">]: </span>166693\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 98687.0 failed 4 times, most recent failure: Lost task 0.3 in stage 98687.0 (TID 1296477, 10.22.254.115, executor 2): org.apache.spark.api.python.PythonException: Traceback (most recent call last):","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-1523402910002278&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      8</span> sample2 <span class=\"ansiyellow\">=</span> workingData2<span class=\"ansiyellow\">.</span>rdd<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> x<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\">(</span>x<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span>Vector<span class=\"ansiyellow\">.</span>dense<span class=\"ansiyellow\">(</span>x<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span>x<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span>x<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">3</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span>Vectors<span class=\"ansiyellow\">.</span>dense<span class=\"ansiyellow\">(</span>cosine_similarity<span class=\"ansiyellow\">(</span>x<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">2</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span>x<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">3</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      9</span> <span class=\"ansired\">#sample2 = workingData2.rdd.map(lambda x:(x[0],x[1],x[2],x[3],float(cosine_similarity(x[2],x[3]))))</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 10</span><span class=\"ansiyellow\"> </span>dfSample <span class=\"ansiyellow\">=</span> sample2<span class=\"ansiyellow\">.</span>toDF<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     11</span> <span class=\"ansired\">#dfSample = udf(lambda x: DenseVector([1 - x, x]), VectorUDT())</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     12</span> dfSample <span class=\"ansiyellow\">=</span> dfSample<span class=\"ansiyellow\">.</span>selectExpr<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;_1 as product_uid&quot;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&quot;_2 as relevance&quot;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&quot;_3 as searchWordNorm&quot;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&quot;_4 as featureNorm&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;_5 as cosine_distance&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/session.pyc</span> in <span class=\"ansicyan\">toDF</span><span class=\"ansiblue\">(self, schema, sampleRatio)</span>\n<span class=\"ansigreen\">     55</span>         <span class=\"ansiyellow\">[</span>Row<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;Alice&apos;</span><span class=\"ansiyellow\">,</span> age<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     56</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">---&gt; 57</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> sparkSession<span class=\"ansiyellow\">.</span>createDataFrame<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> schema<span class=\"ansiyellow\">,</span> sampleRatio<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     58</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     59</span>     RDD<span class=\"ansiyellow\">.</span>toDF <span class=\"ansiyellow\">=</span> toDF<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/session.pyc</span> in <span class=\"ansicyan\">createDataFrame</span><span class=\"ansiblue\">(self, data, schema, samplingRatio, verifySchema)</span>\n<span class=\"ansigreen\">    533</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    534</span>         <span class=\"ansigreen\">if</span> isinstance<span class=\"ansiyellow\">(</span>data<span class=\"ansiyellow\">,</span> RDD<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 535</span><span class=\"ansiyellow\">             </span>rdd<span class=\"ansiyellow\">,</span> schema <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_createFromRDD<span class=\"ansiyellow\">(</span>data<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span>prepare<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> schema<span class=\"ansiyellow\">,</span> samplingRatio<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    536</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    537</span>             rdd<span class=\"ansiyellow\">,</span> schema <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_createFromLocal<span class=\"ansiyellow\">(</span>map<span class=\"ansiyellow\">(</span>prepare<span class=\"ansiyellow\">,</span> data<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> schema<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/session.pyc</span> in <span class=\"ansicyan\">_createFromRDD</span><span class=\"ansiblue\">(self, rdd, schema, samplingRatio)</span>\n<span class=\"ansigreen\">    373</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">    374</span>         <span class=\"ansigreen\">if</span> schema <span class=\"ansigreen\">is</span> None <span class=\"ansigreen\">or</span> isinstance<span class=\"ansiyellow\">(</span>schema<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">(</span>list<span class=\"ansiyellow\">,</span> tuple<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 375</span><span class=\"ansiyellow\">             </span>struct <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_inferSchema<span class=\"ansiyellow\">(</span>rdd<span class=\"ansiyellow\">,</span> samplingRatio<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    376</span>             converter <span class=\"ansiyellow\">=</span> _create_converter<span class=\"ansiyellow\">(</span>struct<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    377</span>             rdd <span class=\"ansiyellow\">=</span> rdd<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span>converter<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/session.pyc</span> in <span class=\"ansicyan\">_inferSchema</span><span class=\"ansiblue\">(self, rdd, samplingRatio)</span>\n<span class=\"ansigreen\">    344</span>         <span class=\"ansiyellow\">:</span><span class=\"ansigreen\">return</span><span class=\"ansiyellow\">:</span> <span class=\"ansiyellow\">:</span><span class=\"ansigreen\">class</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\">&#96;</span>pyspark<span class=\"ansiyellow\">.</span>sql<span class=\"ansiyellow\">.</span>types<span class=\"ansiyellow\">.</span>StructType<span class=\"ansiyellow\">&#96;</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    345</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">--&gt; 346</span><span class=\"ansiyellow\">         </span>first <span class=\"ansiyellow\">=</span> rdd<span class=\"ansiyellow\">.</span>first<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    347</span>         <span class=\"ansigreen\">if</span> <span class=\"ansigreen\">not</span> first<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    348</span>             raise ValueError(&quot;The first row in RDD is empty, &quot;\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/rdd.pyc</span> in <span class=\"ansicyan\">first</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">   1359</span>         ValueError<span class=\"ansiyellow\">:</span> RDD <span class=\"ansigreen\">is</span> empty<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1360</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">-&gt; 1361</span><span class=\"ansiyellow\">         </span>rs <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>take<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1362</span>         <span class=\"ansigreen\">if</span> rs<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1363</span>             <span class=\"ansigreen\">return</span> rs<span class=\"ansiyellow\">[</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/rdd.pyc</span> in <span class=\"ansicyan\">take</span><span class=\"ansiblue\">(self, num)</span>\n<span class=\"ansigreen\">   1341</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1342</span>             p <span class=\"ansiyellow\">=</span> range<span class=\"ansiyellow\">(</span>partsScanned<span class=\"ansiyellow\">,</span> min<span class=\"ansiyellow\">(</span>partsScanned <span class=\"ansiyellow\">+</span> numPartsToTry<span class=\"ansiyellow\">,</span> totalParts<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1343</span><span class=\"ansiyellow\">             </span>res <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>context<span class=\"ansiyellow\">.</span>runJob<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> takeUpToNumLeft<span class=\"ansiyellow\">,</span> p<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1344</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1345</span>             items <span class=\"ansiyellow\">+=</span> res<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/context.pyc</span> in <span class=\"ansicyan\">runJob</span><span class=\"ansiblue\">(self, rdd, partitionFunc, partitions, allowLocal)</span>\n<span class=\"ansigreen\">    990</span>         <span class=\"ansired\"># SparkContext#runJob.</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    991</span>         mappedRDD <span class=\"ansiyellow\">=</span> rdd<span class=\"ansiyellow\">.</span>mapPartitions<span class=\"ansiyellow\">(</span>partitionFunc<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 992</span><span class=\"ansiyellow\">         </span>port <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jvm<span class=\"ansiyellow\">.</span>PythonRDD<span class=\"ansiyellow\">.</span>runJob<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jsc<span class=\"ansiyellow\">.</span>sc<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> mappedRDD<span class=\"ansiyellow\">.</span>_jrdd<span class=\"ansiyellow\">,</span> partitions<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    993</span>         <span class=\"ansigreen\">return</span> list<span class=\"ansiyellow\">(</span>_load_from_socket<span class=\"ansiyellow\">(</span>port<span class=\"ansiyellow\">,</span> mappedRDD<span class=\"ansiyellow\">.</span>_jrdd_deserializer<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    994</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 63</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    317</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    318</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 319</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    320</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    321</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 98687.0 failed 4 times, most recent failure: Lost task 0.3 in stage 98687.0 (TID 1296477, 10.22.254.115, executor 2): org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 177, in main\n    process()\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 172, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/databricks/spark/python/pyspark/serializers.py&quot;, line 285, in dump_stream\n    vs = list(itertools.islice(iterator, batch))\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 1339, in takeUpToNumLeft\n    yield next(iterator)\n  File &quot;&lt;command-1523402910002278&gt;&quot;, line 8, in &lt;lambda&gt;\nNameError: global name &apos;Vector&apos; is not defined\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:193)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:234)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:152)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:63)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:108)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:346)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:748)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1624)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1612)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1611)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1611)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:878)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:878)\n\tat scala.Option.foreach(Option.scala:257)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:878)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1844)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1795)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1783)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:680)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2048)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2069)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2088)\n\tat org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:446)\n\tat org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:280)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:748)\nCaused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 177, in main\n    process()\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 172, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/databricks/spark/python/pyspark/serializers.py&quot;, line 285, in dump_stream\n    vs = list(itertools.islice(iterator, batch))\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 1339, in takeUpToNumLeft\n    yield next(iterator)\n  File &quot;&lt;command-1523402910002278&gt;&quot;, line 8, in &lt;lambda&gt;\nNameError: global name &apos;Vector&apos; is not defined\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:193)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:234)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:152)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:63)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:323)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:287)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:108)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:346)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\n</div>","workflows":[],"startTime":1508527695700,"submitTime":1508527695640,"finishTime":1508527722642,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"722d7500-f67e-4a18-a306-10a0a6a4607e"},{"version":"CommandV1","origId":1523402910002320,"guid":"528a0813-ce2a-4d7a-8698-42d59bb4e355","subtype":"command","commandType":"auto","position":7.75,"command":"from pyspark.ml import Pipeline\nfrom pyspark.ml.regression import RandomForestRegressor\nfrom pyspark.ml.feature import VectorIndexer\nfrom pyspark.ml.evaluation import RegressionEvaluator\n\nfeatureIndexer =\\\n    VectorIndexer(inputCol=\"cosine_distance\", outputCol=\"indexedFeatures\", maxCategories=4).fit(dfSample)\n  \n  # Split the data into training and test sets (30% held out for testing)\n(trainingData, testData) = dfSample.randomSplit([0.7, 0.3])\n\n# Train a RandomForest model.\nrf = RandomForestRegressor(featuresCol=\"indexedFeatures\")\n\n# Chain indexer and forest in a Pipeline\npipeline = Pipeline(stages=[featureIndexer, rf])\n\n# Train model.  This also runs the indexer.\nmodel = pipeline.fit(trainingData)\nresult = model.transform(dfSampleTest)\nresult = result.select(\"id\",result.prediction.cast('float'))\n#result.select(\"id\",round(\"prediction,2))\ndisplay(result)\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[[1016,2.374555],[1017,2.4219964],[1018,2.3826427],[1021,2.403469],[1023,2.3826427],[1024,2.3774023],[1025,2.3750958],[1027,2.384193],[1574,2.361776],[1575,2.399338],[2530,2.38722],[2531,2.3826427],[2532,2.36212],[2533,2.3797271],[2536,2.384193],[2537,2.364368],[4620,2.3557549],[4622,2.3847113],[4623,2.3726146],[4624,2.3726146],[4625,2.36212],[4626,2.3557549],[5053,2.4128263],[5698,2.3115504],[6113,2.3557549],[6114,2.364368],[6116,2.3726146],[6117,2.3557549],[6118,2.3115504],[6119,2.3797271],[6120,2.3115504],[6121,2.4219964],[6122,2.4162252],[6123,2.3797271],[6124,2.3726146],[6125,2.384193],[6126,2.3737812],[6127,2.4162252],[6129,2.38722],[6131,2.3797271],[6133,2.374555],[6134,2.3737812],[6135,2.3797271],[6136,2.3797271],[6137,2.364368],[6332,2.3750958],[6333,2.3686314],[6334,2.403469],[6336,2.4095623],[6337,2.3763733],[6338,2.4128263],[6339,2.3850727],[6340,2.3850727],[6342,2.3797271],[6343,2.3797271],[8694,2.3557549],[8696,2.374555],[9559,2.399338],[9561,2.38722],[12105,2.384193],[14464,2.3774023],[14465,2.4219964],[14467,2.3777773],[14468,2.403469],[14470,2.4095623],[14472,2.4219964],[14474,2.3930006],[14475,2.3763733],[14881,2.364368],[15880,2.4095623],[15881,2.374555],[15882,2.3826427],[15883,2.375842],[15886,2.375842],[17050,2.4095623],[17051,2.399338],[20446,2.3869376],[21002,2.3686314],[21005,2.38722],[21006,2.374555],[21535,2.3557549],[21561,2.3888137],[21563,2.3777773],[23169,2.403469],[23171,2.3686314],[23173,2.3737812],[23655,2.3847113],[23656,2.3797271],[23658,2.3753293],[23769,2.3737812],[23771,2.3888137],[23772,2.3774023],[25488,2.3777773],[25490,2.3750958],[25492,2.3869376],[25494,2.364368],[25495,2.38722],[26849,2.3850727],[26850,2.3726146],[26851,2.4162252],[26852,2.364368],[26853,2.3115504],[26854,2.3888137],[26856,2.3726146],[26858,2.36212],[27294,2.3888137],[27296,2.3930006],[27722,2.403469],[27723,2.4128263],[30188,2.4128263],[30207,2.38722],[30984,2.403469],[31838,2.3826427],[31839,2.4095623],[33475,2.3726146],[33477,2.3850727],[33478,2.3570774],[33479,2.374555],[33482,2.3737812],[33483,2.3737812],[33484,2.4128263],[36517,2.384193],[36521,2.3557549],[36522,2.3930006],[36523,2.3850727],[36526,2.3869376],[36527,2.36212],[36528,2.3763733],[36529,2.374555],[36530,2.3850727],[36861,2.3847113],[36862,2.3797271],[36863,2.3797271],[36866,2.361776],[37692,2.3737812],[37693,2.384193],[37694,2.3869376],[37696,2.3797271],[37697,2.4162252],[37699,2.399338],[38405,2.403469],[38406,2.403469],[38466,2.3774023],[38468,2.3826427],[38845,2.3797271],[40232,2.4095623],[40248,2.38722],[40272,2.3850727],[40900,2.38722],[40901,2.361776],[40903,2.3797271],[40905,2.38722],[40906,2.3888137],[41300,2.3826427],[41302,2.3850727],[41303,2.3115504],[44496,2.3570774],[44498,2.375842],[45787,2.3850727],[45788,2.3750958],[45789,2.3869376],[46033,2.36212],[46034,2.4162252],[46035,2.3557549],[47913,2.3763733],[47914,2.3888137],[50720,2.4095623],[52817,2.3797271],[54477,2.374555],[55348,2.3888137],[55349,2.3753293],[56415,2.3570774],[58359,2.3726146],[58360,2.361776],[58577,2.36212],[59045,2.3797271],[59047,2.4219964],[60470,2.3115504],[60661,2.361776],[63881,2.3930006],[64057,2.3850727],[64058,2.399338],[64060,2.4219964],[64061,2.3763733],[64062,2.3737812],[64064,2.38722],[64065,2.4095623],[64067,2.374555],[64068,2.3930006],[64069,2.3774023],[64070,2.399338],[64072,2.4219964],[65442,2.3888137],[65464,2.361776],[65465,2.361776],[65466,2.3797271],[65467,2.3570774],[65468,2.3750958],[65469,2.3850727],[65470,2.3570774],[65471,2.3570774],[65472,2.3869376],[65473,2.38722],[65984,2.3850727],[65985,2.3797271],[65986,2.3826427],[69553,2.38722],[69554,2.38722],[69786,2.3570774],[69787,2.3737812],[69788,2.3847113],[70556,2.403469],[70557,2.4128263],[72981,2.3763733],[73359,2.3686314],[73735,2.364368],[75817,2.3797271],[75860,2.3797271],[75861,2.3869376],[75862,2.399338],[76112,2.375842],[76889,2.3847113],[77453,2.3763733],[77982,2.374555],[82787,2.3686314],[83426,2.3797271],[83656,2.3826427],[83822,2.364368],[83823,2.36212],[83824,2.3847113],[85667,2.3888137],[85668,2.3750958],[85670,2.364368],[87324,2.374555],[87325,2.364368],[87326,2.3115504],[87721,2.3888137],[87737,2.3777773],[89609,2.374555],[90411,2.3753293],[90413,2.3930006],[90414,2.3826427],[90415,2.3763733],[90416,2.384193],[90417,2.364368],[90418,2.3557549],[90419,2.3115504],[90420,2.38722],[92050,2.4219964],[92051,2.4128263],[92623,2.3888137],[92674,2.3115504],[93177,2.384193],[93987,2.374555],[94533,2.4128263],[94943,2.3869376],[94944,2.374555],[94945,2.3797271],[96006,2.399338],[96536,2.3570774],[96537,2.3557549],[96539,2.3750958],[96540,2.3826427],[96543,2.3888137],[96545,2.375842],[96546,2.384193],[96710,2.3869376],[97922,2.3847113],[97923,2.3888137],[97958,2.3686314],[97959,2.3888137],[97960,2.3750958],[99455,2.3869376],[99456,2.403469],[99457,2.38722],[99458,2.36212],[99459,2.3797271],[100842,2.3750958],[101145,2.374555],[101146,2.3115504],[102047,2.3777773],[102224,2.3737812],[103890,2.3774023],[103955,2.3750958],[103956,2.4219964],[104726,2.3777773],[104838,2.3847113],[104858,2.4128263],[104860,2.3797271],[104861,2.3930006],[105202,2.384193],[105724,2.374555],[106187,2.38722],[106337,2.3797271],[107264,2.3570774],[107972,2.3753293],[107973,2.3869376],[107974,2.3930006],[107977,2.3557549],[107979,2.3797271],[108136,2.4162252],[108141,2.384193],[108142,2.384193],[108211,2.399338],[108714,2.3115504],[108715,2.36212],[108716,2.36212],[109064,2.3737812],[109316,2.38722],[110051,2.374555],[110255,2.3797271],[110275,2.3797271],[110277,2.3888137],[110278,2.4095623],[110280,2.364368],[111681,2.3726146],[111682,2.3763733],[112626,2.3750958],[112775,2.384193],[112913,2.4162252],[113333,2.3726146],[113608,2.3850727],[113609,2.3850727],[113610,2.384193],[116726,2.3737812],[116955,2.3826427],[117170,2.3826427],[117172,2.3797271],[117580,2.3726146],[117824,2.3737812],[117825,2.3888137],[117826,2.38722],[117827,2.384193],[117948,2.3726146],[117949,2.3869376],[117950,2.364368],[118381,2.3850727],[118382,2.3777773],[118541,2.3115504],[118953,2.36212],[118955,2.3777773],[119477,2.361776],[120029,2.3777773],[121537,2.399338],[121539,2.3777773],[121790,2.3850727],[122005,2.3797271],[122918,2.364368],[122919,2.374555],[122920,2.3115504],[123203,2.364368],[123204,2.3777773],[125196,2.3850727],[125438,2.3930006],[126039,2.3869376],[126040,2.4162252],[126041,2.3570774],[126679,2.3888137],[127082,2.403469],[127084,2.3686314],[127085,2.374555],[127086,2.3888137],[127942,2.3930006],[127943,2.36212],[127944,2.3777773],[128052,2.3797271],[128401,2.374555],[128402,2.3750958],[128443,2.3753293],[128940,2.399338],[129116,2.3753293],[129195,2.3797271],[129196,2.4219964],[129307,2.3930006],[129308,2.4128263],[129355,2.403469],[129553,2.3797271],[130145,2.38722],[130146,2.3737812],[130149,2.4095623],[130150,2.3930006],[130151,2.4095623],[130152,2.3797271],[130153,2.364368],[131216,2.3869376],[131228,2.384193],[131585,2.3570774],[131586,2.364368],[131955,2.3797271],[132055,2.364368],[132056,2.3850727],[132057,2.3888137],[132276,2.3888137],[132277,2.4095623],[132280,2.384193],[133103,2.364368],[133670,2.4162252],[133671,2.361776],[133672,2.3557549],[134119,2.3850727],[134462,2.3777773],[134463,2.3930006],[134464,2.3797271],[134955,2.3850727],[135150,2.3850727],[135582,2.384193],[135693,2.3930006],[135695,2.3777773],[135696,2.4162252],[137870,2.3847113],[137871,2.3557549],[138409,2.3570774],[139227,2.364368],[139241,2.3557549],[139473,2.3850727],[139474,2.38722],[139619,2.384193],[139620,2.361776],[139621,2.4162252],[140019,2.4095623],[140447,2.3797271],[140480,2.3777773],[142338,2.364368],[142523,2.36212],[142607,2.3850727],[143698,2.399338],[144918,2.3737812],[144919,2.3869376],[144920,2.4162252],[144921,2.361776],[144922,2.384193],[145567,2.364368],[146210,2.3115504],[146368,2.3686314],[146369,2.3847113],[146649,2.384193],[147095,2.3774023],[147096,2.4162252],[147119,2.364368],[147120,2.4219964],[148229,2.3750958],[148230,2.4219964],[148231,2.3847113],[148603,2.361776],[148605,2.403469],[148916,2.3726146],[149050,2.3763733],[149267,2.36212],[149268,2.364368],[149269,2.3115504],[149884,2.3753293],[149885,2.3869376],[149886,2.3726146],[149980,2.3115504],[150236,2.3557549],[150237,2.3557549],[150306,2.384193],[150477,2.399338],[150478,2.374555],[150589,2.3750958],[150595,2.3797271],[150869,2.3888137],[151063,2.374555],[151223,2.38722],[151224,2.361776],[151531,2.3557549],[151532,2.38722],[152304,2.36212],[152394,2.3826427],[153047,2.3763733],[153048,2.3753293],[153895,2.4219964],[153896,2.3686314],[153898,2.3726146],[153899,2.375842],[154033,2.3847113],[154456,2.403469],[154825,2.384193],[156921,2.3753293],[157283,2.403469],[157339,2.3774023],[157738,2.3847113],[157739,2.3763733],[157859,2.364368],[158183,2.399338],[158184,2.4162252],[158277,2.36212],[158959,2.3869376],[158960,2.3888137],[159069,2.3777773],[159070,2.399338],[160460,2.3826427],[160461,2.3115504],[160633,2.3726146],[160733,2.3763733],[160798,2.3850727],[160842,2.36212],[161098,2.3763733],[161099,2.3850727],[161100,2.3753293],[162066,2.3869376],[163534,2.3777773],[163619,2.3774023],[164571,2.3750958],[164572,2.3774023],[165715,2.3930006],[165716,2.3797271],[166023,2.4128263],[166570,2.3847113],[166571,2.3797271],[167085,2.4095623],[167098,2.3763733],[167155,2.36212],[167758,2.38722],[167859,2.403469],[167888,2.3570774],[167889,2.4128263],[168040,2.3115504],[168575,2.3763733],[168959,2.38722],[169462,2.375842],[169870,2.3750958],[171083,2.361776],[171587,2.3797271],[173353,2.38722],[173355,2.3930006],[174042,2.361776],[174486,2.375842],[174857,2.375842],[174858,2.364368],[174859,2.3850727],[174922,2.399338],[175395,2.38722],[175706,2.3763733],[176165,2.4219964],[176726,2.3797271],[177017,2.3888137],[177018,2.3774023],[177019,2.3930006],[177020,2.3774023],[177022,2.3557549],[177164,2.3763733],[177675,2.3930006],[177834,2.374555],[178498,2.361776],[178774,2.3750958],[179093,2.384193],[180999,2.3686314],[181004,2.3826427],[181040,2.3930006],[181041,2.3774023],[181042,2.3686314],[181047,2.3797271],[181127,2.3888137],[181253,2.3726146],[181426,2.374555],[181447,2.4162252],[181448,2.4219964],[181596,2.3763733],[181686,2.3869376],[181746,2.3797271],[182017,2.3777773],[182338,2.375842],[182422,2.3888137],[183419,2.38722],[183487,2.375842],[184268,2.374555],[185268,2.361776],[185353,2.36212],[185787,2.374555],[185801,2.4219964],[186577,2.3763733],[186712,2.3826427],[186787,2.3750958],[187343,2.3557549],[188007,2.3557549],[188058,2.4095623],[188192,2.3777773],[188193,2.3888137],[188194,2.3570774],[188957,2.364368],[189007,2.4128263],[189008,2.384193],[189094,2.374555],[189506,2.3847113],[189507,2.384193],[189508,2.364368],[189757,2.3826427],[190199,2.3869376],[190563,2.374555],[190976,2.4095623],[191588,2.38722],[191937,2.3797271],[192381,2.3826427],[192382,2.4095623],[194033,2.4162252],[194702,2.3826427],[195374,2.3774023],[195375,2.3737812],[195390,2.4162252],[195397,2.3686314],[195639,2.4128263],[196098,2.3686314],[196099,2.384193],[196463,2.38722],[196699,2.3847113],[196700,2.3888137],[196743,2.375842],[196744,2.3930006],[196840,2.38722],[197428,2.3847113],[197831,2.361776],[198144,2.3115504],[198241,2.3726146],[198303,2.3737812],[198875,2.361776],[198879,2.3570774],[198880,2.3726146],[199360,2.374555],[199515,2.3930006],[199550,2.3737812],[199644,2.3686314],[199712,2.3797271],[199796,2.3888137],[199841,2.3763733],[200000,2.3750958],[200001,2.3753293],[200206,2.3726146],[200257,2.3797271],[200632,2.3115504],[201517,2.4219964],[202991,2.364368],[202997,2.361776],[203250,2.375842],[203727,2.3774023],[203728,2.3850727],[203908,2.3557549],[204517,2.374555],[204518,2.3750958],[205060,2.3930006],[205239,2.36212],[205275,2.3115504],[205276,2.3888137],[205856,2.399338],[205977,2.3797271],[206917,2.399338],[207540,2.364368],[207578,2.3797271],[207908,2.3774023],[207942,2.3777773],[208045,2.3850727],[208103,2.3826427],[208253,2.3888137],[208254,2.399338],[208297,2.4128263],[209563,2.403469],[209564,2.3797271],[209583,2.3726146],[210228,2.4128263],[210743,2.3869376],[211179,2.4095623],[211289,2.384193],[211290,2.3750958],[211453,2.3115504],[211454,2.3750958],[211507,2.3750958],[211958,2.3797271],[212345,2.3726146],[213488,2.4162252],[213860,2.375842],[213861,2.4162252],[214119,2.36212],[214407,2.384193],[214486,2.3737812],[214707,2.4162252],[215687,2.3850727],[215984,2.3750958],[216358,2.3869376],[216368,2.3930006],[216370,2.3686314],[216816,2.4095623],[217135,2.4128263],[217757,2.384193],[217846,2.38722],[217944,2.3777773],[218294,2.3930006],[219424,2.3869376],[219425,2.374555],[219537,2.3847113],[219580,2.3869376],[219915,2.4128263],[219996,2.361776],[220194,2.3686314],[220520,2.4095623],[220875,2.4162252],[221118,2.36212],[221119,2.3826427],[221149,2.4128263],[221294,2.3930006],[221295,2.403469],[221565,2.4162252],[221681,2.3686314],[222015,2.3557549],[222343,2.3115504],[223292,2.3557549],[223293,2.3797271],[223772,2.3847113],[223773,2.4095623],[223889,2.3777773],[224273,2.375842],[224274,2.4095623],[224620,2.3686314],[225357,2.3753293],[225358,2.375842],[225610,2.3753293],[225917,2.3888137],[226161,2.3888137],[226191,2.374555],[226239,2.3888137],[226240,2.3763733],[226249,2.361776],[226275,2.3850727],[226276,2.3797271],[226591,2.3777773],[226592,2.3850727],[226677,2.38722],[226905,2.3115504],[227542,2.36212],[227652,2.384193],[227656,2.36212],[227839,2.3115504],[227973,2.3570774],[227974,2.3557549],[228199,2.384193],[228450,2.3850727],[228779,2.4095623],[228852,2.3753293],[229051,2.36212],[229096,2.3686314],[229286,2.3777773],[229321,2.3847113],[229444,2.3826427],[229445,2.36212],[229463,2.3750958],[230027,2.3930006],[230450,2.3850727],[230570,2.3777773],[230634,2.374555],[230654,2.361776],[231274,2.3686314],[231275,2.361776],[231822,2.3115504],[231831,2.4128263],[231832,2.3869376],[231833,2.374555],[232006,2.3763733],[232026,2.3930006],[232035,2.3737812],[232141,2.36212],[232166,2.3797271],[232167,2.361776],[232685,2.4128263],[232694,2.3797271],[232702,2.3888137],[232703,2.3847113],[232923,2.3869376],[232930,2.4095623],[233022,2.3797271],[233207,2.36212],[233212,2.3797271],[233790,2.38722],[234209,2.3753293],[234340,2.3930006],[234596,2.361776],[234791,2.3115504],[235132,2.375842],[235571,2.3930006],[235741,2.3797271],[235750,2.4128263],[235786,2.384193],[236037,2.3115504],[236661,2.3826427],[236942,2.3115504],[237415,2.3753293],[237416,2.3750958],[237488,2.4162252],[238040,2.3557549],[238106,2.3737812],[238158,2.3726146],[238353,2.3869376],[238860,2.3737812],[238873,2.3797271],[238924,2.3797271],[239032,2.361776],[239052,2.38722],[239249,2.3726146],[239346,2.38722],[239802,2.3737812],[432,2.4095623],[433,2.399338],[434,2.4095623],[435,2.4095623],[436,2.399338],[437,2.3930006],[438,2.4095623],[439,2.399338],[441,2.3797271],[442,2.4095623],[443,2.4095623],[448,2.4128263],[449,2.3753293],[450,2.3737812],[451,2.3797271],[453,2.3763733],[457,2.3930006],[538,2.399338],[539,2.4162252],[540,2.4162252],[541,2.3847113],[1263,2.3888137],[2565,2.374555],[3234,2.3797271],[3236,2.403469],[3237,2.4162252],[3239,2.3826427],[3504,2.3557549],[3505,2.36212],[3508,2.3847113],[3510,2.3570774],[3511,2.361776],[3512,2.3570774],[8073,2.3869376],[8575,2.374555],[8577,2.361776],[9071,2.3686314],[9072,2.3557549],[9723,2.399338],[9724,2.36212],[9725,2.3557549],[10155,2.361776],[10156,2.399338],[10258,2.375842],[10259,2.3115504],[10378,2.403469],[10379,2.3570774],[10380,2.3750958],[10381,2.361776],[10383,2.3777773],[10384,2.3797271],[10737,2.3774023],[10739,2.4219964],[10741,2.3888137],[11390,2.4219964],[11392,2.4162252],[11908,2.4219964],[12927,2.4219964],[12928,2.36212],[13945,2.375842],[13946,2.3737812],[13947,2.4095623],[13948,2.374555],[17334,2.403469],[17336,2.3570774],[17338,2.3570774],[17339,2.3570774],[17340,2.3570774],[17342,2.3115504],[18912,2.3847113],[18913,2.3777773],[18914,2.3737812],[19696,2.3753293],[19697,2.3797271],[21131,2.364368],[22484,2.36212],[22485,2.3115504],[23650,2.3797271],[23701,2.3797271],[23702,2.3797271],[23705,2.384193],[23706,2.38722],[23968,2.3888137],[25871,2.361776],[25872,2.3869376],[25873,2.3750958],[26521,2.3737812],[26523,2.3774023],[27448,2.3726146],[27449,2.3570774],[27450,2.3686314],[27600,2.3726146],[28800,2.36212],[28803,2.3726146],[28804,2.364368],[30292,2.3686314],[30294,2.4162252],[30314,2.3686314],[32855,2.3847113],[33589,2.4128263],[33590,2.403469],[34771,2.3826427],[34772,2.3850727],[36934,2.3557549],[36935,2.3753293],[36937,2.3847113],[36938,2.3797271],[36976,2.3737812],[37070,2.399338],[37387,2.3737812],[37926,2.3847113],[37927,2.3797271],[38267,2.361776],[38268,2.3777773],[38270,2.3570774],[38272,2.4095623],[38273,2.4095623],[39190,2.3726146],[39193,2.3888137],[39194,2.3737812],[40826,2.3750958],[40827,2.3826427],[41367,2.384193],[41369,2.3570774],[41370,2.3797271],[41372,2.4095623],[42604,2.364368],[42680,2.3888137],[42810,2.3797271],[42811,2.403469],[42813,2.3826427],[45358,2.399338],[46220,2.3930006],[46549,2.3869376],[46550,2.3869376],[46792,2.3686314],[48418,2.375842],[48419,2.38722],[48421,2.3737812],[48422,2.374555],[48423,2.3777773],[48425,2.4219964],[48689,2.364368],[48715,2.399338],[48940,2.361776],[49891,2.399338],[52042,2.3737812],[52043,2.4219964],[52045,2.4162252],[52047,2.4219964],[52048,2.4128263],[52049,2.374555],[52050,2.361776],[52052,2.3763733],[52054,2.4095623],[52055,2.3753293],[52056,2.4219964],[54378,2.3777773],[54379,2.3869376],[54380,2.4219964],[54382,2.3774023],[54742,2.3774023],[54743,2.374555],[55337,2.3797271],[55338,2.375842],[57433,2.3750958],[57863,2.4128263],[59363,2.3737812],[59719,2.3888137],[59720,2.399338],[60691,2.4219964],[60692,2.3726146],[60695,2.403469],[60696,2.4219964],[60697,2.4095623],[60698,2.3686314],[60701,2.3888137],[60702,2.4219964],[60703,2.399338],[60704,2.4095623],[60705,2.3570774],[60848,2.403469],[62186,2.375842],[62187,2.3726146],[62312,2.3797271],[62313,2.3797271],[62340,2.364368],[62341,2.3763733],[62491,2.3557549],[63249,2.38722],[63741,2.384193],[63742,2.384193],[63743,2.3570774],[63847,2.3557549],[65542,2.364368],[65543,2.3115504],[65544,2.36212],[65668,2.3737812],[65669,2.3777773],[65670,2.3686314],[66193,2.3774023],[66688,2.3850727]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"long\"","metadata":"{}"},{"name":"prediction","type":"\"float\"","metadata":"{}"}],"overflow":true,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":"dbfs:/databricks-results/1523402910002320/","datasetInfos":[]},"errorSummary":"AmazonS3Exception: Forbidden (Service: Amazon S3; Status Code: 403; Error Code: 403 Forbidden; Request ID: 31AC31F24539CCB8)","error":"com.amazonaws.services.s3.model.AmazonS3Exception: Forbidden (Service: Amazon S3; Status Code: 403; Error Code: 403 Forbidden; Request ID: 31AC31F24539CCB8), S3 Extended Request ID: 35naKtaOVGheaoE/ndZumK/+iI0CtBSeaZrkzzjDJJeGfJvvqESPqDaAy/LwK5ps3aPg1zaxllU=\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.handleErrorResponse(AmazonHttpClient.java:1588)\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeOneRequest(AmazonHttpClient.java:1258)\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1030)\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.doExecute(AmazonHttpClient.java:742)\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeWithTimer(AmazonHttpClient.java:716)\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.execute(AmazonHttpClient.java:699)\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.access$500(AmazonHttpClient.java:667)\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutionBuilderImpl.execute(AmazonHttpClient.java:649)\n\tat com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:513)\n\tat com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:4169)\n\tat com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:4116)\n\tat com.amazonaws.services.s3.AmazonS3Client.getObjectMetadata(AmazonS3Client.java:1237)\n\tat com.databricks.s3a.aws.EnforcingDatabricksS3Client.getObjectMetadata(EnforcingDatabricksS3Client.scala:190)\n\tat com.databricks.s3a.S3AFileSystem.getFileStatus(S3AFileSystem.java:990)\n\tat com.databricks.s3a.S3AFileSystem.getFileStatus(S3AFileSystem.java:72)\n\tat org.apache.hadoop.fs.FileSystem.exists(FileSystem.java:1426)\n\tat com.databricks.s3a.S3AFileSystem.createFakeDirectoryIfNecessary(S3AFileSystem.java:787)\n\tat com.databricks.s3a.S3AFileSystem.delete(S3AFileSystem.java:775)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2$$anonfun$delete$1$$anonfun$apply$mcZ$sp$3$$anonfun$apply$mcZ$sp$4.apply$mcZ$sp(DatabricksFileSystemV2.scala:401)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2$$anonfun$delete$1$$anonfun$apply$mcZ$sp$3$$anonfun$apply$mcZ$sp$4.apply(DatabricksFileSystemV2.scala:399)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2$$anonfun$delete$1$$anonfun$apply$mcZ$sp$3$$anonfun$apply$mcZ$sp$4.apply(DatabricksFileSystemV2.scala:399)\n\tat com.databricks.s3a.S3AExeceptionUtils$.convertAWSExceptionToJavaIOException(DatabricksStreamUtils.scala:107)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2$$anonfun$delete$1$$anonfun$apply$mcZ$sp$3.apply$mcZ$sp(DatabricksFileSystemV2.scala:398)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2$$anonfun$delete$1$$anonfun$apply$mcZ$sp$3.apply(DatabricksFileSystemV2.scala:398)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2$$anonfun$delete$1$$anonfun$apply$mcZ$sp$3.apply(DatabricksFileSystemV2.scala:398)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2$$anonfun$withUserContextRecorded$1.apply(DatabricksFileSystemV2.scala:594)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:188)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:183)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2.withAttributionContext(DatabricksFileSystemV2.scala:214)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:221)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2.withAttributionTags(DatabricksFileSystemV2.scala:214)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2.withUserContextRecorded(DatabricksFileSystemV2.scala:574)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2$$anonfun$delete$1.apply$mcZ$sp(DatabricksFileSystemV2.scala:397)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2$$anonfun$delete$1.apply(DatabricksFileSystemV2.scala:397)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2$$anonfun$delete$1.apply(DatabricksFileSystemV2.scala:397)\n\tat com.databricks.logging.UsageLogging$$anonfun$recordOperation$1.apply(UsageLogging.scala:312)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:188)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:183)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2.withAttributionContext(DatabricksFileSystemV2.scala:214)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:221)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2.withAttributionTags(DatabricksFileSystemV2.scala:214)\n\tat com.databricks.logging.UsageLogging$class.recordOperation(UsageLogging.scala:298)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2.recordOperation(DatabricksFileSystemV2.scala:214)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2.delete(DatabricksFileSystemV2.scala:396)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystem.delete(DatabricksFileSystem.scala:128)\n\tat org.apache.spark.internal.io.FileCommitProtocol.deleteWithJob(FileCommitProtocol.scala:122)\n\tat com.databricks.sql.transaction.directory.DirectoryAtomicCommitProtocol.deleteWithJob(DirectoryAtomicCommitProtocol.scala:97)\n\tat org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.deleteMatchingPartitions(InsertIntoHadoopFsRelationCommand.scala:194)\n\tat org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:113)\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult$lzycompute(commands.scala:68)\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.sideEffectResult(commands.scala:63)\n\tat org.apache.spark.sql.execution.command.ExecutedCommandExec.doExecute(commands.scala:86)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:117)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:138)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:135)\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:116)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:94)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:94)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:610)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:610)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:610)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:234)\n\tat com.databricks.SparkShim$.saveAsCSV(SparkShim.scala:43)\n\tat com.databricks.backend.daemon.driver.OutputAggregator$.com$databricks$backend$daemon$driver$OutputAggregator$$storeResultsToDBFS(OutputAggregator.scala:103)\n\tat com.databricks.backend.daemon.driver.OutputAggregator$$anonfun$2.apply(OutputAggregator.scala:83)\n\tat com.databricks.backend.daemon.driver.OutputAggregator$$anonfun$2.apply(OutputAggregator.scala:82)\n\tat scala.Option.map(Option.scala:146)\n\tat com.databricks.backend.daemon.driver.OutputAggregator$.withOutputAggregation0(OutputAggregator.scala:82)\n\tat com.databricks.backend.daemon.driver.OutputAggregator$.withOutputAggregation(OutputAggregator.scala:42)\n\tat com.databricks.backend.daemon.driver.PythonDriverLocal$$anonfun$getResultBuffer$1.apply(PythonDriverLocal.scala:474)\n\tat com.databricks.backend.daemon.driver.PythonDriverLocal$$anonfun$getResultBuffer$1.apply(PythonDriverLocal.scala:445)\n\tat com.databricks.backend.daemon.driver.PythonDriverLocal.withInterpLock(PythonDriverLocal.scala:398)\n\tat com.databricks.backend.daemon.driver.PythonDriverLocal.getResultBuffer(PythonDriverLocal.scala:445)\n\tat com.databricks.backend.daemon.driver.PythonDriverLocal.com$databricks$backend$daemon$driver$PythonDriverLocal$$outputSuccess(PythonDriverLocal.scala:432)\n\tat com.databricks.backend.daemon.driver.PythonDriverLocal$$anonfun$repl$3.apply(PythonDriverLocal.scala:182)\n\tat com.databricks.backend.daemon.driver.PythonDriverLocal$$anonfun$repl$3.apply(PythonDriverLocal.scala:179)\n\tat com.databricks.backend.daemon.driver.PythonDriverLocal.withInterpLock(PythonDriverLocal.scala:398)\n\tat com.databricks.backend.daemon.driver.PythonDriverLocal.repl(PythonDriverLocal.scala:179)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:234)\n\tat com.databricks.backend.daemon.driver.DriverLocal$$anonfun$execute$3.apply(DriverLocal.scala:215)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:188)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:58)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:183)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionContext(DriverLocal.scala:39)\n\tat com.databricks.logging.UsageLogging$class.withAttributionTags(UsageLogging.scala:221)\n\tat com.databricks.backend.daemon.driver.DriverLocal.withAttributionTags(DriverLocal.scala:39)\n\tat com.databricks.backend.daemon.driver.DriverLocal.execute(DriverLocal.scala:215)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat com.databricks.backend.daemon.driver.DriverWrapper$$anonfun$tryExecutingCommand$2.apply(DriverWrapper.scala:589)\n\tat scala.util.Try$.apply(Try.scala:192)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.tryExecutingCommand(DriverWrapper.scala:584)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.executeCommand(DriverWrapper.scala:488)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInnerLoop(DriverWrapper.scala:391)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.runInner(DriverWrapper.scala:348)\n\tat com.databricks.backend.daemon.driver.DriverWrapper.run(DriverWrapper.scala:215)\n\tat java.lang.Thread.run(Thread.java:748)\n","workflows":[],"startTime":1508541669929,"submitTime":1508541669864,"finishTime":1508541728805,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"2963b4d0-b09c-4f94-b261-079f98129db0"},{"version":"CommandV1","origId":1523402910002321,"guid":"e7eb6346-8d28-46dd-9c73-bda4dee9468c","subtype":"command","commandType":"auto","position":8.125,"command":"# Make predictions.\npredictions = model.transform(testData)\n\n# Select example rows to display.\npredictions.select(\"prediction\", \"label\", \"cosine_distance\").show(5)\n\nevaluator = RegressionEvaluator(\n    labelCol=\"label\", predictionCol=\"prediction\", metricName=\"rmse\")\nrmse = evaluator.evaluate(predictions)\nprint(\"Root Mean Squared Error (RMSE) on test data = %g\" % rmse)\n\nrfModel = model.stages[1]\nprint(rfModel)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------------------+-----+--------------------+\n|        prediction|label|     cosine_distance|\n+------------------+-----+--------------------+\n|2.3681843820931308|  1.0|[0.16006294797433...|\n|2.3854599461008363| 1.67|[0.4644555055299677]|\n| 2.376569933434795| 1.67|[0.35498358519186...|\n| 2.376569933434795| 1.67|[0.3642912384237322]|\n| 2.386649989513301| 2.67|[0.34198152428409...|\n+------------------+-----+--------------------+\nonly showing top 5 rows\n\nRoot Mean Squared Error (RMSE) on test data = 0.533526\nRandomForestRegressionModel (uid=RandomForestRegressor_41a68ebb301a946a7e83) with 20 trees\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":"<span class=\"ansired\">AnalysisException</span>: u&quot;cannot resolve &apos;&#96;features&#96;&apos; given input columns: [product_uid, searchWordNorm, prediction, featureNorm, label, cosine_distance, indexedFeatures];;\\n&apos;Project [prediction#413840, label#413731, &apos;features]\\n+- Project [product_uid#413730L, label#413731, searchWordNorm#413732, featureNorm#413733, cosine_distance#413734, indexedFeatures#413832, UDF(indexedFeatures#413832) AS prediction#413840]\\n   +- Project [product_uid#413730L, label#413731, searchWordNorm#413732, featureNorm#413733, cosine_distance#413734, UDF(cosine_distance#413734) AS indexedFeatures#413832]\\n      +- Sample 0.7, 1.0, false, 1952137930518479313\\n         +- Sort [product_uid#413730L ASC NULLS FIRST, label#413731 ASC NULLS FIRST, searchWordNorm#413732 ASC NULLS FIRST, featureNorm#413733 ASC NULLS FIRST, cosine_distance#413734 ASC NULLS FIRST], false\\n            +- Project [_1#413719L AS product_uid#413730L, _2#413720 AS label#413731, _3#413721 AS searchWordNorm#413732, _4#413722 AS featureNorm#413733, _5#413723 AS cosine_distance#413734]\\n               +- LogicalRDD [_1#413719L, _2#413720, _3#413721, _4#413722, _5#413723]\\n&quot;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;command-1523402910002321&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      3</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> <span class=\"ansired\"># Select example rows to display.</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 5</span><span class=\"ansiyellow\"> </span>predictions<span class=\"ansiyellow\">.</span>select<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;prediction&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;label&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;features&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>show<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">5</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/dataframe.pyc</span> in <span class=\"ansicyan\">select</span><span class=\"ansiblue\">(self, *cols)</span>\n<span class=\"ansigreen\">   1039</span>         <span class=\"ansiyellow\">[</span>Row<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;Alice&apos;</span><span class=\"ansiyellow\">,</span> age<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">12</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> Row<span class=\"ansiyellow\">(</span>name<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">u&apos;Bob&apos;</span><span class=\"ansiyellow\">,</span> age<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">15</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1040</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">-&gt; 1041</span><span class=\"ansiyellow\">         </span>jdf <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">.</span>select<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jcols<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>cols<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1042</span>         <span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>jdf<span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>sql_ctx<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1043</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     67</span>                                              e.java_exception.getStackTrace()))\n<span class=\"ansigreen\">     68</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.AnalysisException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 69</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     70</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;org.apache.spark.sql.catalyst.analysis&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     71</span>                 <span class=\"ansigreen\">raise</span> AnalysisException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">AnalysisException</span>: u&quot;cannot resolve &apos;&#96;features&#96;&apos; given input columns: [product_uid, searchWordNorm, prediction, featureNorm, label, cosine_distance, indexedFeatures];;\\n&apos;Project [prediction#413840, label#413731, &apos;features]\\n+- Project [product_uid#413730L, label#413731, searchWordNorm#413732, featureNorm#413733, cosine_distance#413734, indexedFeatures#413832, UDF(indexedFeatures#413832) AS prediction#413840]\\n   +- Project [product_uid#413730L, label#413731, searchWordNorm#413732, featureNorm#413733, cosine_distance#413734, UDF(cosine_distance#413734) AS indexedFeatures#413832]\\n      +- Sample 0.7, 1.0, false, 1952137930518479313\\n         +- Sort [product_uid#413730L ASC NULLS FIRST, label#413731 ASC NULLS FIRST, searchWordNorm#413732 ASC NULLS FIRST, featureNorm#413733 ASC NULLS FIRST, cosine_distance#413734 ASC NULLS FIRST], false\\n            +- Project [_1#413719L AS product_uid#413730L, _2#413720 AS label#413731, _3#413721 AS searchWordNorm#413732, _4#413722 AS featureNorm#413733, _5#413723 AS cosine_distance#413734]\\n               +- LogicalRDD [_1#413719L, _2#413720, _3#413721, _4#413722, _5#413723]\\n&quot;</div>","workflows":[],"startTime":1508541597283,"submitTime":1508541568687,"finishTime":1508541606438,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c664f6cd-76a0-41d7-bb41-89c9eda173a9"}],"dashboards":[],"guid":"2a470ede-6c61-409a-ab71-07b55214a615","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
